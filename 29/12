#Region "Imports"

Imports System.IO
Imports System.Xml
Imports System.Text
Imports SiU.Process.WebServiceAPI.ServiceCommon
Imports siu.Process.Windows.Core.forms
Imports siu.Process.Common.Functions.CommonMethod
Imports SiU.Process.Common.Functions.SystemValue
Imports DataDynamics.ActiveReports
Imports DataDynamics.ActiveReports.Document

#End Region

''' <summary>
''' 請求推移表
''' </summary>
''' <remarks>請求推移表</remarks>
''' <history version="5.0.3.1" date="2013.12.12" name="HUY-NQ">新規作成</history>
Public Class Report

#Region " 定数／変数 "

    Const cstErrNoSettingData As String = "500" 'レポート初期設定値取得エラー

    ''' <summary>IsError -- エラー判定フラグ</summary>
    Public IsError As Boolean = False
    ''' <summary>ErrorMsg -- エラーメッセージ</summary>
    Public ErrorMsg As String = String.Empty
    ''' <summary>wsCommon -- </summary>
    Protected wsCommon As ServiceCommon
    ''' <summary>rpt_ds -- レポート用データセット</summary>
    Protected DsRep As New DataSet
    ''' <summary>ProgramCode -- プログラムコード</summary>
    Protected Shared ProgramCode As Integer
    ''' <summary>paramKey -- 帳票出力条件検索キー</summary>
    Protected paramKey As Decimal
    ''' <summary>帳票タイトル</summary>
    Protected ReportTitle As String = String.Empty
    ''' <summary>文書番号</summary>
    Protected DocNo As String = String.Empty
    
#End Region

#Region "その他"

    ''' <summary>
    ''' インチ/センチ変換係数(長さのローカライズ設定に応じて設定)
    ''' </summary>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    ReadOnly Property InchToCmPara() As Single
        Get

            '' システム設定でメートル法が使用されている場合

            If System.Globalization.RegionInfo.CurrentRegion.IsMetric Then
                '' Cm⇒Inch変換係数を設定

                Return 2.54!

            Else
                '' 係数を１に設定

                Return 1.0!

            End If

        End Get
    End Property

#End Region

#Region "コンストラクタ等"

    ''' <summary>
    ''' New -- コンストラクタ
    ''' </summary>
    ''' <param name="pProgramCode">プログラムコード（帳票ID）</param>
    ''' <param name="pParameterNo">検索条件取得キー</param>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Public Sub New(ByVal pProgramCode As Integer, ByVal pParameterNo As Decimal)

        MyBase.New()

        '' ActiveReport デザイナで必要です。
        InitializeComponent()

        '' Webサービスの参照を引き継ぐ
        wsCommon = EntryPoint.wsCommon

        '' 帳票出力条件検索キーをモジュール変数に設定
        paramKey = pParameterNo

        '' プログラムコードをモジュール変数に設定
        ProgramCode = pProgramCode

        '' 呼出元パラメータ取得
        Me.getParam(pParameterNo)

        '' 呼出元パラメータ削除（※使用済の一時データをクリア）
        Me.deleteParam(pParameterNo)

        ''レイアウト読み込み
        Call Me.LoadReport()

    End Sub

    ''' <summary>DataBind -- データ取得とバインド</summary>
    ''' <returns></returns>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Public Function dataBind() As Boolean

        Try

            '' レコードセット取得
            DsRep = getDataSet()

            Return True

        Catch ex As Exception
            '' 例外は再スロー
            Throw ex

            Return False

        End Try

    End Function

#End Region

#Region "レポート設定"

    ''' <summary>reportSetting -- レポート設定</summary>
    ''' <remarks>各種レポート設定（用紙サイズ、余白など）</remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub reportSetting()

        Try
            Dim config As DataRow = Me.getProperty()

            '' 用紙サイズ
            Dim nPaperSize As Integer = fToInt(config.Item("RPT_PAPER"))
            Dim nPaperHeight As Single = fToNumberEx(Of Single)(config.Item("RPT_PAPER_HEIGHT"))
            Dim nPaperWidth As Single = fToNumberEx(Of Single)(config.Item("RPT_PAPER_WIDTH"))

            If nPaperSize = 0 AndAlso nPaperHeight = 0.0! AndAlso nPaperWidth = 0.0! Then
                '' 未設定は何もしない
            ElseIf nPaperSize = 0 Then
                '' カスタム用紙は高さ、幅で設定
                Me.PageSettings.PaperHeight = nPaperHeight
                Me.PageSettings.PaperWidth = nPaperWidth
            Else
                '' 用紙種類で設定
                Me.PageSettings.PaperKind = DirectCast(nPaperSize, System.Drawing.Printing.PaperKind)
            End If

            '' ページ方向
            Dim nOrientation As Integer = fToInt(config.Item("RPT_ORIENTATION"))
            If nOrientation = 0 Then
                Me.PageSettings.Orientation = PageOrientation.Default
            Else
                Me.PageSettings.Orientation = DirectCast(nOrientation, PageOrientation)
            End If

            '' 余白(DBはインチで設定されているので、システムの既定単位に変換する)
            Me.PageSettings.Margins = New Margins(20, 0, 15, 0)
        Catch ex As Exception
            Select Case ex.Message
                Case cstErrNoSettingData

                    'T_PROPERTYにデータが存在しなかった場合はエラーにしない
                    MyBase.PageSettings.Margins = New Margins(0.79, 0, 0.5, 0)
                Case Else
                    IsError = True
                    ErrorMsg = ex.Message
                    Throw ex
            End Select

        End Try

    End Sub

    ''' <summary>
    ''' LoadReport
    ''' </summary>
    ''' <remarks>帳票レイアウトをロードする</remarks>
    ''' <history version ="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub LoadReport()

        If Hensu.xReport_Path = String.Empty Then
            Exit Sub
        End If

        '' 会社マスタロード
        Call GetKaisMaster(SysKais)

        'プログラム情報取得
        Me.getProgram()

        '' 帳票レイアウトをロードする
        Me.LoadLayout(Hensu.xReport_Path)

        Me.ReportHeader = CType(Me.Sections("ReportHeader"), DataDynamics.ActiveReports.ReportHeader)
        Me.PageHeader = CType(Me.Sections("PageHeader"), DataDynamics.ActiveReports.PageHeader)
        Me.txtSysDate = CType(Me.PageHeader.Controls("txtSysDate"), DataDynamics.ActiveReports.TextBox)
        Me.txtKANSEI_OPT = CType(Me.PageHeader.Controls("txtKANSEI_OPT"), DataDynamics.ActiveReports.TextBox)
        Me.lblKANSEI_OPT = CType(Me.PageHeader.Controls("lblKANSEI_OPT"), DataDynamics.ActiveReports.Label)
        Me.txtDDATE = CType(Me.PageHeader.Controls("txtDDATE"), DataDynamics.ActiveReports.TextBox)
        Me.txtORDER_OPT_NAME = CType(Me.PageHeader.Controls("txtORDER_OPT_NAME"), DataDynamics.ActiveReports.TextBox)
        Me.lblBACKGROUND = CType(Me.PageHeader.Controls("lblBACKGROUND"), DataDynamics.ActiveReports.Label)
        Me.lblJYUTYU = CType(Me.PageHeader.Controls("lblJYUTYU"), DataDynamics.ActiveReports.Label)
        Me.lblN3 = CType(Me.PageHeader.Controls("lblN3"), DataDynamics.ActiveReports.Label)
        Me.lblKOJ_TANT = CType(Me.PageHeader.Controls("lblKOJ_TANT"), DataDynamics.ActiveReports.Label)
        Me.lblN6MS = CType(Me.PageHeader.Controls("lblN6MS"), DataDynamics.ActiveReports.Label)
        Me.lblN6MN = CType(Me.PageHeader.Controls("lblN6MN"), DataDynamics.ActiveReports.Label)
        Me.lblN6MZ = CType(Me.PageHeader.Controls("lblN6MZ"), DataDynamics.ActiveReports.Label)
        Me.lblNS5 = CType(Me.PageHeader.Controls("lblNS5"), DataDynamics.ActiveReports.Label)
        Me.lblNN5 = CType(Me.PageHeader.Controls("lblNN5"), DataDynamics.ActiveReports.Label)
        Me.lblSN5 = CType(Me.PageHeader.Controls("lblSN5"), DataDynamics.ActiveReports.Label)
        Me.lblSN4 = CType(Me.PageHeader.Controls("lblSN4"), DataDynamics.ActiveReports.Label)
        Me.lblNN4 = CType(Me.PageHeader.Controls("lblNN4"), DataDynamics.ActiveReports.Label)
        Me.lblNS4 = CType(Me.PageHeader.Controls("lblNS4"), DataDynamics.ActiveReports.Label)
        Me.lblNS3 = CType(Me.PageHeader.Controls("lblNS3"), DataDynamics.ActiveReports.Label)
        Me.lblNN3 = CType(Me.PageHeader.Controls("lblNN3"), DataDynamics.ActiveReports.Label)
        Me.lblSN3 = CType(Me.PageHeader.Controls("lblSN3"), DataDynamics.ActiveReports.Label)
        Me.lblSN2 = CType(Me.PageHeader.Controls("lblSN2"), DataDynamics.ActiveReports.Label)
        Me.lblNN2 = CType(Me.PageHeader.Controls("lblNN2"), DataDynamics.ActiveReports.Label)
        Me.lblNS2 = CType(Me.PageHeader.Controls("lblNS2"), DataDynamics.ActiveReports.Label)
        Me.lblNS1 = CType(Me.PageHeader.Controls("lblNS1"), DataDynamics.ActiveReports.Label)
        Me.lblNN1 = CType(Me.PageHeader.Controls("lblNN1"), DataDynamics.ActiveReports.Label)
        Me.lblSN1 = CType(Me.PageHeader.Controls("lblSN1"), DataDynamics.ActiveReports.Label)
        Me.lblSN = CType(Me.PageHeader.Controls("lblSN"), DataDynamics.ActiveReports.Label)
        Me.lblNN = CType(Me.PageHeader.Controls("lblNN"), DataDynamics.ActiveReports.Label)
        Me.lblNS = CType(Me.PageHeader.Controls("lblNS"), DataDynamics.ActiveReports.Label)
        Me.lblN1MS = CType(Me.PageHeader.Controls("lblN1MS"), DataDynamics.ActiveReports.Label)
        Me.lblN1MN = CType(Me.PageHeader.Controls("lblN1MN"), DataDynamics.ActiveReports.Label)
        Me.lblN1MZ = CType(Me.PageHeader.Controls("lblN1MZ"), DataDynamics.ActiveReports.Label)
        Me.lblN2 = CType(Me.PageHeader.Controls("lblN2"), DataDynamics.ActiveReports.Label)
        Me.lblZEI_TAIS = CType(Me.PageHeader.Controls("lblZEI_TAIS"), DataDynamics.ActiveReports.Label)
        Me.lblZEI = CType(Me.PageHeader.Controls("lblZEI"), DataDynamics.ActiveReports.Label)
        Me.lblSYUNKOU = CType(Me.PageHeader.Controls("lblSYUNKOU"), DataDynamics.ActiveReports.Label)
        Me.lblKAN_FURI = CType(Me.PageHeader.Controls("lblKAN_FURI"), DataDynamics.ActiveReports.Label)
        Me.lblN1 = CType(Me.PageHeader.Controls("lblN1"), DataDynamics.ActiveReports.Label)
        Me.lblKOUHOU = CType(Me.PageHeader.Controls("lblKOUHOU"), DataDynamics.ActiveReports.Label)
        Me.lblBMN_UW = CType(Me.PageHeader.Controls("lblBMN_UW"), DataDynamics.ActiveReports.Label)
        Me.lblMISEI_KIN = CType(Me.PageHeader.Controls("lblMISEI_KIN"), DataDynamics.ActiveReports.Label)
        Me.lblTANT = CType(Me.PageHeader.Controls("lblTANT"), DataDynamics.ActiveReports.Label)
        Me.lblN5MY = CType(Me.PageHeader.Controls("lblN5MY"), DataDynamics.ActiveReports.Label)
        Me.txtREPORT_TITLE = CType(Me.PageHeader.Controls("txtREPORT_TITLE"), DataDynamics.ActiveReports.Label)
        Me.txtDocNo = CType(Me.PageHeader.Controls("txtDocNo"), DataDynamics.ActiveReports.Label)
        Me.Line7 = CType(Me.PageHeader.Controls("Line7"), DataDynamics.ActiveReports.Line)
        Me.Line8 = CType(Me.PageHeader.Controls("Line8"), DataDynamics.ActiveReports.Line)
        Me.lblKOJ = CType(Me.PageHeader.Controls("lblKOJ"), DataDynamics.ActiveReports.Label)
        Me.Line26 = CType(Me.PageHeader.Controls("Line26"), DataDynamics.ActiveReports.Line)
        Me.Line25 = CType(Me.PageHeader.Controls("Line25"), DataDynamics.ActiveReports.Line)
        Me.lblURI_KIN = CType(Me.PageHeader.Controls("lblURI_KIN"), DataDynamics.ActiveReports.Label)
        Me.lblKEIY_KIN = CType(Me.PageHeader.Controls("lblKEIY_KIN"), DataDynamics.ActiveReports.Label)
        Me.lblN1MY = CType(Me.PageHeader.Controls("lblN1MY"), DataDynamics.ActiveReports.Label)
        Me.lblNY = CType(Me.PageHeader.Controls("lblNY"), DataDynamics.ActiveReports.Label)
        Me.lblNY1 = CType(Me.PageHeader.Controls("lblNY1"), DataDynamics.ActiveReports.Label)
        Me.lblNY2 = CType(Me.PageHeader.Controls("lblNY2"), DataDynamics.ActiveReports.Label)
        Me.lblNY3 = CType(Me.PageHeader.Controls("lblNY3"), DataDynamics.ActiveReports.Label)
        Me.lblNY4 = CType(Me.PageHeader.Controls("lblNY4"), DataDynamics.ActiveReports.Label)
        Me.lblNY5 = CType(Me.PageHeader.Controls("lblNY5"), DataDynamics.ActiveReports.Label)
        Me.Line20 = CType(Me.PageHeader.Controls("Line20"), DataDynamics.ActiveReports.Line)
        Me.Line24 = CType(Me.PageHeader.Controls("Line24"), DataDynamics.ActiveReports.Line)
        Me.Line3 = CType(Me.PageHeader.Controls("Line3"), DataDynamics.ActiveReports.Line)
        Me.Line9 = CType(Me.PageHeader.Controls("Line9"), DataDynamics.ActiveReports.Line)
        Me.Line11 = CType(Me.PageHeader.Controls("Line11"), DataDynamics.ActiveReports.Line)
        Me.Line12 = CType(Me.PageHeader.Controls("Line12"), DataDynamics.ActiveReports.Line)
        Me.Line14 = CType(Me.PageHeader.Controls("Line14"), DataDynamics.ActiveReports.Line)
        Me.Line15 = CType(Me.PageHeader.Controls("Line15"), DataDynamics.ActiveReports.Line)
        Me.Line16 = CType(Me.PageHeader.Controls("Line16"), DataDynamics.ActiveReports.Line)
        Me.Line17 = CType(Me.PageHeader.Controls("Line17"), DataDynamics.ActiveReports.Line)
        Me.Line19 = CType(Me.PageHeader.Controls("Line19"), DataDynamics.ActiveReports.Line)
        Me.Line21 = CType(Me.PageHeader.Controls("Line21"), DataDynamics.ActiveReports.Line)
        Me.Line18 = CType(Me.PageHeader.Controls("Line18"), DataDynamics.ActiveReports.Line)
        Me.Line75 = CType(Me.PageHeader.Controls("Line75"), DataDynamics.ActiveReports.Line)
        Me.Line76 = CType(Me.PageHeader.Controls("Line76"), DataDynamics.ActiveReports.Line)
        Me.Line77 = CType(Me.PageHeader.Controls("Line77"), DataDynamics.ActiveReports.Line)
        Me.Line109 = CType(Me.PageHeader.Controls("Line109"), DataDynamics.ActiveReports.Line)
        Me.Line110 = CType(Me.PageHeader.Controls("Line110"), DataDynamics.ActiveReports.Line)
        Me.Line111 = CType(Me.PageHeader.Controls("Line111"), DataDynamics.ActiveReports.Line)
        Me.Line112 = CType(Me.PageHeader.Controls("Line112"), DataDynamics.ActiveReports.Line)
        Me.Line113 = CType(Me.PageHeader.Controls("Line113"), DataDynamics.ActiveReports.Line)
        Me.Line114 = CType(Me.PageHeader.Controls("Line114"), DataDynamics.ActiveReports.Line)
        Me.Line116 = CType(Me.PageHeader.Controls("Line116"), DataDynamics.ActiveReports.Line)
        Me.GroupHeader1 = CType(Me.Sections("GroupHeader1"), DataDynamics.ActiveReports.GroupHeader)
        Me.GroupHeader2 = CType(Me.Sections("GroupHeader2"), DataDynamics.ActiveReports.GroupHeader)
        Me.lblKAISYU_HORYU_RITU = CType(Me.GroupHeader2.Controls("lblKAISYU_HORYU_RITU"), DataDynamics.ActiveReports.Label)
        Me.lblKAISYU_KIN_RITU = CType(Me.GroupHeader2.Controls("lblKAISYU_KIN_RITU"), DataDynamics.ActiveReports.Label)
        Me.txtHORYU_RITU = CType(Me.GroupHeader2.Controls("txtHORYU_RITU"), DataDynamics.ActiveReports.TextBox)
        Me.txtKAISYU_KIN_RITU = CType(Me.GroupHeader2.Controls("txtKAISYU_KIN_RITU"), DataDynamics.ActiveReports.TextBox)
        Me.txtKAISYU = CType(Me.GroupHeader2.Controls("txtKAISYU"), DataDynamics.ActiveReports.TextBox)
        Me.txtKAISYU_TEG_SAIT = CType(Me.GroupHeader2.Controls("txtKAISYU_TEG_SAIT"), DataDynamics.ActiveReports.TextBox)
        Me.lblKAISYU_TEG_SAIT = CType(Me.GroupHeader2.Controls("lblKAISYU_TEG_SAIT"), DataDynamics.ActiveReports.Label)
        Me.txtKAISYU_TEG_RITU = CType(Me.GroupHeader2.Controls("txtKAISYU_TEG_RITU"), DataDynamics.ActiveReports.TextBox)
        Me.lblKAISYU_TEG_RITU = CType(Me.GroupHeader2.Controls("lblKAISYU_TEG_RITU"), DataDynamics.ActiveReports.Label)
        Me.lblKAISYU = CType(Me.GroupHeader2.Controls("lblKAISYU"), DataDynamics.ActiveReports.Label)
        Me.txtSEIK = CType(Me.GroupHeader2.Controls("txtSEIK"), DataDynamics.ActiveReports.TextBox)
        Me.lblSIME_HACH = CType(Me.GroupHeader2.Controls("lblSIME_HACH"), DataDynamics.ActiveReports.Label)
        Me.txtSIME_HACH = CType(Me.GroupHeader2.Controls("txtSIME_HACH"), DataDynamics.ActiveReports.TextBox)
        Me.txtKOJ_NAME = CType(Me.GroupHeader2.Controls("txtKOJ_NAME"), DataDynamics.ActiveReports.TextBox)
        Me.Line5 = CType(Me.GroupHeader2.Controls("Line5"), DataDynamics.ActiveReports.Line)
        Me.Line46 = CType(Me.GroupHeader2.Controls("Line46"), DataDynamics.ActiveReports.Line)
        Me.Line55 = CType(Me.GroupHeader2.Controls("Line55"), DataDynamics.ActiveReports.Line)
        Me.Line78 = CType(Me.GroupHeader2.Controls("Line78"), DataDynamics.ActiveReports.Line)
        Me.Line79 = CType(Me.GroupHeader2.Controls("Line79"), DataDynamics.ActiveReports.Line)
        Me.Line80 = CType(Me.GroupHeader2.Controls("Line80"), DataDynamics.ActiveReports.Line)
        Me.Line81 = CType(Me.GroupHeader2.Controls("Line81"), DataDynamics.ActiveReports.Line)
        Me.Line82 = CType(Me.GroupHeader2.Controls("Line82"), DataDynamics.ActiveReports.Line)
        Me.Line83 = CType(Me.GroupHeader2.Controls("Line83"), DataDynamics.ActiveReports.Line)
        Me.Line84 = CType(Me.GroupHeader2.Controls("Line84"), DataDynamics.ActiveReports.Line)
        Me.Line85 = CType(Me.GroupHeader2.Controls("Line85"), DataDynamics.ActiveReports.Line)
        Me.Line86 = CType(Me.GroupHeader2.Controls("Line86"), DataDynamics.ActiveReports.Line)
        Me.Line87 = CType(Me.GroupHeader2.Controls("Line87"), DataDynamics.ActiveReports.Line)
        Me.Line88 = CType(Me.GroupHeader2.Controls("Line88"), DataDynamics.ActiveReports.Line)
        Me.Line89 = CType(Me.GroupHeader2.Controls("Line89"), DataDynamics.ActiveReports.Line)
        Me.Line90 = CType(Me.GroupHeader2.Controls("Line90"), DataDynamics.ActiveReports.Line)
        Me.Line106 = CType(Me.GroupHeader2.Controls("Line106"), DataDynamics.ActiveReports.Line)
        Me.GroupHeader3 = CType(Me.Sections("GroupHeader3"), DataDynamics.ActiveReports.GroupHeader)
        Me.txtKAISYU2 = CType(Me.GroupHeader3.Controls("txtKAISYU2"), DataDynamics.ActiveReports.TextBox)
        Me.txtKAISYU_KIN_RITU2 = CType(Me.GroupHeader3.Controls("txtKAISYU_KIN_RITU2"), DataDynamics.ActiveReports.TextBox)
        Me.txtHORYU_RITU2 = CType(Me.GroupHeader3.Controls("txtHORYU_RITU2"), DataDynamics.ActiveReports.TextBox)
        Me.Label6 = CType(Me.GroupHeader3.Controls("Label6"), DataDynamics.ActiveReports.Label)
        Me.Label5 = CType(Me.GroupHeader3.Controls("Label5"), DataDynamics.ActiveReports.Label)
        Me.txtKAISYU_TEG_SAIT2 = CType(Me.GroupHeader3.Controls("txtKAISYU_TEG_SAIT2"), DataDynamics.ActiveReports.TextBox)
        Me.Label1 = CType(Me.GroupHeader3.Controls("Label1"), DataDynamics.ActiveReports.Label)
        Me.txtKAISYU_TEG_RITU2 = CType(Me.GroupHeader3.Controls("txtKAISYU_TEG_RITU2"), DataDynamics.ActiveReports.TextBox)
        Me.Label2 = CType(Me.GroupHeader3.Controls("Label2"), DataDynamics.ActiveReports.Label)
        Me.Label3 = CType(Me.GroupHeader3.Controls("Label3"), DataDynamics.ActiveReports.Label)
        Me.txtSEIK2 = CType(Me.GroupHeader3.Controls("txtSEIK2"), DataDynamics.ActiveReports.TextBox)
        Me.Label4 = CType(Me.GroupHeader3.Controls("Label4"), DataDynamics.ActiveReports.Label)
        Me.txtSIME_HACH2 = CType(Me.GroupHeader3.Controls("txtSIME_HACH2"), DataDynamics.ActiveReports.TextBox)
        Me.txtKOJ_NAME2 = CType(Me.GroupHeader3.Controls("txtKOJ_NAME2"), DataDynamics.ActiveReports.TextBox)
        Me.Line91 = CType(Me.GroupHeader3.Controls("Line91"), DataDynamics.ActiveReports.Line)
        Me.Line92 = CType(Me.GroupHeader3.Controls("Line92"), DataDynamics.ActiveReports.Line)
        Me.Line93 = CType(Me.GroupHeader3.Controls("Line93"), DataDynamics.ActiveReports.Line)
        Me.Line94 = CType(Me.GroupHeader3.Controls("Line94"), DataDynamics.ActiveReports.Line)
        Me.Line95 = CType(Me.GroupHeader3.Controls("Line95"), DataDynamics.ActiveReports.Line)
        Me.Line96 = CType(Me.GroupHeader3.Controls("Line96"), DataDynamics.ActiveReports.Line)
        Me.Line97 = CType(Me.GroupHeader3.Controls("Line97"), DataDynamics.ActiveReports.Line)
        Me.Line98 = CType(Me.GroupHeader3.Controls("Line98"), DataDynamics.ActiveReports.Line)
        Me.Line99 = CType(Me.GroupHeader3.Controls("Line99"), DataDynamics.ActiveReports.Line)
        Me.Line100 = CType(Me.GroupHeader3.Controls("Line100"), DataDynamics.ActiveReports.Line)
        Me.Line101 = CType(Me.GroupHeader3.Controls("Line101"), DataDynamics.ActiveReports.Line)
        Me.Line102 = CType(Me.GroupHeader3.Controls("Line102"), DataDynamics.ActiveReports.Line)
        Me.Line103 = CType(Me.GroupHeader3.Controls("Line103"), DataDynamics.ActiveReports.Line)
        Me.Line104 = CType(Me.GroupHeader3.Controls("Line104"), DataDynamics.ActiveReports.Line)
        Me.Line105 = CType(Me.GroupHeader3.Controls("Line105"), DataDynamics.ActiveReports.Line)
        Me.Line107 = CType(Me.GroupHeader3.Controls("Line107"), DataDynamics.ActiveReports.Line)
        Me.Line108 = CType(Me.GroupHeader3.Controls("Line108"), DataDynamics.ActiveReports.Line)
        Me.Detail = CType(Me.Sections("Detail"), DataDynamics.ActiveReports.Detail)
        Me.txtOTHERS = CType(Me.Detail.Controls("txtOTHERS"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN_SZ8 = CType(Me.Detail.Controls("txtKIN_SZ8"), DataDynamics.ActiveReports.TextBox)
        Me.txtKOUHOU = CType(Me.Detail.Controls("txtKOUHOU"), DataDynamics.ActiveReports.TextBox)
        Me.txtBMN_UW = CType(Me.Detail.Controls("txtBMN_UW"), DataDynamics.ActiveReports.TextBox)
        Me.txtHACH = CType(Me.Detail.Controls("txtHACH"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN26 = CType(Me.Detail.Controls("txtKIN26"), DataDynamics.ActiveReports.TextBox)
        Me.txtMISEI_KIN = CType(Me.Detail.Controls("txtMISEI_KIN"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN27 = CType(Me.Detail.Controls("txtKIN27"), DataDynamics.ActiveReports.TextBox)
        Me.txtKOJ_TANT_NAME = CType(Me.Detail.Controls("txtKOJ_TANT_NAME"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN25 = CType(Me.Detail.Controls("txtKIN25"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN22 = CType(Me.Detail.Controls("txtKIN22"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN19 = CType(Me.Detail.Controls("txtKIN19"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN16 = CType(Me.Detail.Controls("txtKIN16"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN_SZ4 = CType(Me.Detail.Controls("txtKIN_SZ4"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN10 = CType(Me.Detail.Controls("txtKIN10"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN8 = CType(Me.Detail.Controls("txtKIN8"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN4 = CType(Me.Detail.Controls("txtKIN4"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN1 = CType(Me.Detail.Controls("txtKIN1"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN35 = CType(Me.Detail.Controls("txtKIN35"), DataDynamics.ActiveReports.TextBox)
        Me.txtKOJ = CType(Me.Detail.Controls("txtKOJ"), DataDynamics.ActiveReports.TextBox)
        Me.Line41 = CType(Me.Detail.Controls("Line41"), DataDynamics.ActiveReports.Line)
        Me.txtSYUNKO = CType(Me.Detail.Controls("txtSYUNKO"), DataDynamics.ActiveReports.TextBox)
        Me.txtKAN_FURI = CType(Me.Detail.Controls("txtKAN_FURI"), DataDynamics.ActiveReports.TextBox)
        Me.lblM1 = CType(Me.Detail.Controls("lblM1"), DataDynamics.ActiveReports.TextBox)
        Me.Line44 = CType(Me.Detail.Controls("Line44"), DataDynamics.ActiveReports.Line)
        Me.txtKIN2 = CType(Me.Detail.Controls("txtKIN2"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN3 = CType(Me.Detail.Controls("txtKIN3"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN5 = CType(Me.Detail.Controls("txtKIN5"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN6 = CType(Me.Detail.Controls("txtKIN6"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN_SZ1 = CType(Me.Detail.Controls("txtKIN_SZ1"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN7 = CType(Me.Detail.Controls("txtKIN7"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN9 = CType(Me.Detail.Controls("txtKIN9"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN_SZ2 = CType(Me.Detail.Controls("txtKIN_SZ2"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN11 = CType(Me.Detail.Controls("txtKIN11"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN12 = CType(Me.Detail.Controls("txtKIN12"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN_SZ3 = CType(Me.Detail.Controls("txtKIN_SZ3"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN13 = CType(Me.Detail.Controls("txtKIN13"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN14 = CType(Me.Detail.Controls("txtKIN14"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN15 = CType(Me.Detail.Controls("txtKIN15"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN17 = CType(Me.Detail.Controls("txtKIN17"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN18 = CType(Me.Detail.Controls("txtKIN18"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN_SZ5 = CType(Me.Detail.Controls("txtKIN_SZ5"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN20 = CType(Me.Detail.Controls("txtKIN20"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN21 = CType(Me.Detail.Controls("txtKIN21"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN_SZ6 = CType(Me.Detail.Controls("txtKIN_SZ6"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN23 = CType(Me.Detail.Controls("txtKIN23"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN24 = CType(Me.Detail.Controls("txtKIN24"), DataDynamics.ActiveReports.TextBox)
        Me.txtKIN_SZ7 = CType(Me.Detail.Controls("txtKIN_SZ7"), DataDynamics.ActiveReports.TextBox)
        Me.txtEIGYO_TANT_NAME = CType(Me.Detail.Controls("txtEIGYO_TANT_NAME"), DataDynamics.ActiveReports.TextBox)
        Me.Line23 = CType(Me.Detail.Controls("Line23"), DataDynamics.ActiveReports.Line)
        Me.Line45 = CType(Me.Detail.Controls("Line45"), DataDynamics.ActiveReports.Line)
        Me.Line42 = CType(Me.Detail.Controls("Line42"), DataDynamics.ActiveReports.Line)
        Me.Line52 = CType(Me.Detail.Controls("Line52"), DataDynamics.ActiveReports.Line)
        Me.Line47 = CType(Me.Detail.Controls("Line47"), DataDynamics.ActiveReports.Line)
        Me.Line48 = CType(Me.Detail.Controls("Line48"), DataDynamics.ActiveReports.Line)
        Me.Line53 = CType(Me.Detail.Controls("Line53"), DataDynamics.ActiveReports.Line)
        Me.Line49 = CType(Me.Detail.Controls("Line49"), DataDynamics.ActiveReports.Line)
        Me.Line50 = CType(Me.Detail.Controls("Line50"), DataDynamics.ActiveReports.Line)
        Me.Line54 = CType(Me.Detail.Controls("Line54"), DataDynamics.ActiveReports.Line)
        Me.Line43 = CType(Me.Detail.Controls("Line43"), DataDynamics.ActiveReports.Line)
        Me.Line4 = CType(Me.Detail.Controls("Line4"), DataDynamics.ActiveReports.Line)
        Me.Line67 = CType(Me.Detail.Controls("Line67"), DataDynamics.ActiveReports.Line)
        Me.Line68 = CType(Me.Detail.Controls("Line68"), DataDynamics.ActiveReports.Line)
        Me.Line39 = CType(Me.Detail.Controls("Line39"), DataDynamics.ActiveReports.Line)
        Me.GroupFooter3 = CType(Me.Sections("GroupFooter3"), DataDynamics.ActiveReports.GroupFooter)
        Me.GroupFooter2 = CType(Me.Sections("GroupFooter2"), DataDynamics.ActiveReports.GroupFooter)
        Me.txtTOTAL_SEIK = CType(Me.GroupFooter2.Controls("txtTOTAL_SEIK"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_MISEI_KIN = CType(Me.GroupFooter2.Controls("txtS_MISEI_KIN"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN25 = CType(Me.GroupFooter2.Controls("txtS_KIN25"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN_SZ8 = CType(Me.GroupFooter2.Controls("txtS_KIN_SZ8"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN27 = CType(Me.GroupFooter2.Controls("txtS_KIN27"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN26 = CType(Me.GroupFooter2.Controls("txtS_KIN26"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN22 = CType(Me.GroupFooter2.Controls("txtS_KIN22"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN19 = CType(Me.GroupFooter2.Controls("txtS_KIN19"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN16 = CType(Me.GroupFooter2.Controls("txtS_KIN16"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN_SZ4 = CType(Me.GroupFooter2.Controls("txtS_KIN_SZ4"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN10 = CType(Me.GroupFooter2.Controls("txtS_KIN10"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN8 = CType(Me.GroupFooter2.Controls("txtS_KIN8"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN_28 = CType(Me.GroupFooter2.Controls("txtS_KIN_28"), DataDynamics.ActiveReports.TextBox)
        Me.Line2 = CType(Me.GroupFooter2.Controls("Line2"), DataDynamics.ActiveReports.Line)
        Me.txtS_KIN2 = CType(Me.GroupFooter2.Controls("txtS_KIN2"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN3 = CType(Me.GroupFooter2.Controls("txtS_KIN3"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN5 = CType(Me.GroupFooter2.Controls("txtS_KIN5"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN6 = CType(Me.GroupFooter2.Controls("txtS_KIN6"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN_SZ1 = CType(Me.GroupFooter2.Controls("txtS_KIN_SZ1"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN7 = CType(Me.GroupFooter2.Controls("txtS_KIN7"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN9 = CType(Me.GroupFooter2.Controls("txtS_KIN9"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN_SZ2 = CType(Me.GroupFooter2.Controls("txtS_KIN_SZ2"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN11 = CType(Me.GroupFooter2.Controls("txtS_KIN11"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN12 = CType(Me.GroupFooter2.Controls("txtS_KIN12"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN_SZ3 = CType(Me.GroupFooter2.Controls("txtS_KIN_SZ3"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN13 = CType(Me.GroupFooter2.Controls("txtS_KIN13"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN14 = CType(Me.GroupFooter2.Controls("txtS_KIN14"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN15 = CType(Me.GroupFooter2.Controls("txtS_KIN15"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN17 = CType(Me.GroupFooter2.Controls("txtS_KIN17"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN18 = CType(Me.GroupFooter2.Controls("txtS_KIN18"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN_SZ5 = CType(Me.GroupFooter2.Controls("txtS_KIN_SZ5"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN20 = CType(Me.GroupFooter2.Controls("txtS_KIN20"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN21 = CType(Me.GroupFooter2.Controls("txtS_KIN21"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN_SZ6 = CType(Me.GroupFooter2.Controls("txtS_KIN_SZ6"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN23 = CType(Me.GroupFooter2.Controls("txtS_KIN23"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN24 = CType(Me.GroupFooter2.Controls("txtS_KIN24"), DataDynamics.ActiveReports.TextBox)
        Me.txtS_KIN_SZ7 = CType(Me.GroupFooter2.Controls("txtS_KIN_SZ7"), DataDynamics.ActiveReports.TextBox)
        Me.Line22 = CType(Me.GroupFooter2.Controls("Line22"), DataDynamics.ActiveReports.Line)
        Me.Line27 = CType(Me.GroupFooter2.Controls("Line27"), DataDynamics.ActiveReports.Line)
        Me.Line28 = CType(Me.GroupFooter2.Controls("Line28"), DataDynamics.ActiveReports.Line)
        Me.Line29 = CType(Me.GroupFooter2.Controls("Line29"), DataDynamics.ActiveReports.Line)
        Me.Line30 = CType(Me.GroupFooter2.Controls("Line30"), DataDynamics.ActiveReports.Line)
        Me.Line31 = CType(Me.GroupFooter2.Controls("Line31"), DataDynamics.ActiveReports.Line)
        Me.Line56 = CType(Me.GroupFooter2.Controls("Line56"), DataDynamics.ActiveReports.Line)
        Me.Line57 = CType(Me.GroupFooter2.Controls("Line57"), DataDynamics.ActiveReports.Line)
        Me.Line58 = CType(Me.GroupFooter2.Controls("Line58"), DataDynamics.ActiveReports.Line)
        Me.Line59 = CType(Me.GroupFooter2.Controls("Line59"), DataDynamics.ActiveReports.Line)
        Me.Line1 = CType(Me.GroupFooter2.Controls("Line1"), DataDynamics.ActiveReports.Line)
        Me.txtS_KIN1 = CType(Me.GroupFooter2.Controls("txtS_KIN1"), DataDynamics.ActiveReports.TextBox)
        Me.Line6 = CType(Me.GroupFooter2.Controls("Line6"), DataDynamics.ActiveReports.Line)
        Me.txtS_KIN4 = CType(Me.GroupFooter2.Controls("txtS_KIN4"), DataDynamics.ActiveReports.TextBox)
        Me.Line10 = CType(Me.GroupFooter2.Controls("Line10"), DataDynamics.ActiveReports.Line)
        Me.Line69 = CType(Me.GroupFooter2.Controls("Line69"), DataDynamics.ActiveReports.Line)
        Me.Line70 = CType(Me.GroupFooter2.Controls("Line70"), DataDynamics.ActiveReports.Line)
        Me.Line71 = CType(Me.GroupFooter2.Controls("Line71"), DataDynamics.ActiveReports.Line)
        Me.GroupFooter1 = CType(Me.Sections("GroupFooter1"), DataDynamics.ActiveReports.GroupFooter)
        Me.txtSS_MISEI_KIN = CType(Me.GroupFooter1.Controls("txtSS_MISEI_KIN"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN_SZ8 = CType(Me.GroupFooter1.Controls("txtSS_KIN_SZ8"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN27 = CType(Me.GroupFooter1.Controls("txtSS_KIN27"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN26 = CType(Me.GroupFooter1.Controls("txtSS_KIN26"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN25 = CType(Me.GroupFooter1.Controls("txtSS_KIN25"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN22 = CType(Me.GroupFooter1.Controls("txtSS_KIN22"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN19 = CType(Me.GroupFooter1.Controls("txtSS_KIN19"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN16 = CType(Me.GroupFooter1.Controls("txtSS_KIN16"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN_SZ4 = CType(Me.GroupFooter1.Controls("txtSS_KIN_SZ4"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN10 = CType(Me.GroupFooter1.Controls("txtSS_KIN10"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN8 = CType(Me.GroupFooter1.Controls("txtSS_KIN8"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN35 = CType(Me.GroupFooter1.Controls("txtSS_KIN35"), DataDynamics.ActiveReports.TextBox)
        Me.txtBackgroundGray = CType(Me.GroupFooter1.Controls("txtBackgroundGray"), DataDynamics.ActiveReports.TextBox)
        Me.Line13 = CType(Me.GroupFooter1.Controls("Line13"), DataDynamics.ActiveReports.Line)
        Me.txtSS_KIN2 = CType(Me.GroupFooter1.Controls("txtSS_KIN2"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN3 = CType(Me.GroupFooter1.Controls("txtSS_KIN3"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN5 = CType(Me.GroupFooter1.Controls("txtSS_KIN5"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN6 = CType(Me.GroupFooter1.Controls("txtSS_KIN6"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN_SZ1 = CType(Me.GroupFooter1.Controls("txtSS_KIN_SZ1"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN7 = CType(Me.GroupFooter1.Controls("txtSS_KIN7"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN9 = CType(Me.GroupFooter1.Controls("txtSS_KIN9"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN_SZ2 = CType(Me.GroupFooter1.Controls("txtSS_KIN_SZ2"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN11 = CType(Me.GroupFooter1.Controls("txtSS_KIN11"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN12 = CType(Me.GroupFooter1.Controls("txtSS_KIN12"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN_SZ3 = CType(Me.GroupFooter1.Controls("txtSS_KIN_SZ3"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN13 = CType(Me.GroupFooter1.Controls("txtSS_KIN13"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN14 = CType(Me.GroupFooter1.Controls("txtSS_KIN14"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN15 = CType(Me.GroupFooter1.Controls("txtSS_KIN15"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN17 = CType(Me.GroupFooter1.Controls("txtSS_KIN17"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN18 = CType(Me.GroupFooter1.Controls("txtSS_KIN18"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN_SZ5 = CType(Me.GroupFooter1.Controls("txtSS_KIN_SZ5"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN20 = CType(Me.GroupFooter1.Controls("txtSS_KIN20"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN21 = CType(Me.GroupFooter1.Controls("txtSS_KIN21"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN_SZ6 = CType(Me.GroupFooter1.Controls("txtSS_KIN_SZ6"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN23 = CType(Me.GroupFooter1.Controls("txtSS_KIN23"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN24 = CType(Me.GroupFooter1.Controls("txtSS_KIN24"), DataDynamics.ActiveReports.TextBox)
        Me.txtSS_KIN_SZ7 = CType(Me.GroupFooter1.Controls("txtSS_KIN_SZ7"), DataDynamics.ActiveReports.TextBox)
        Me.Line34 = CType(Me.GroupFooter1.Controls("Line34"), DataDynamics.ActiveReports.Line)
        Me.Line35 = CType(Me.GroupFooter1.Controls("Line35"), DataDynamics.ActiveReports.Line)
        Me.Line36 = CType(Me.GroupFooter1.Controls("Line36"), DataDynamics.ActiveReports.Line)
        Me.Line37 = CType(Me.GroupFooter1.Controls("Line37"), DataDynamics.ActiveReports.Line)
        Me.Line38 = CType(Me.GroupFooter1.Controls("Line38"), DataDynamics.ActiveReports.Line)
        Me.Line51 = CType(Me.GroupFooter1.Controls("Line51"), DataDynamics.ActiveReports.Line)
        Me.Line61 = CType(Me.GroupFooter1.Controls("Line61"), DataDynamics.ActiveReports.Line)
        Me.Line62 = CType(Me.GroupFooter1.Controls("Line62"), DataDynamics.ActiveReports.Line)
        Me.Line63 = CType(Me.GroupFooter1.Controls("Line63"), DataDynamics.ActiveReports.Line)
        Me.Line64 = CType(Me.GroupFooter1.Controls("Line64"), DataDynamics.ActiveReports.Line)
        Me.Line66 = CType(Me.GroupFooter1.Controls("Line66"), DataDynamics.ActiveReports.Line)
        Me.txtSS_KIN1 = CType(Me.GroupFooter1.Controls("txtSS_KIN1"), DataDynamics.ActiveReports.TextBox)
        Me.Line32 = CType(Me.GroupFooter1.Controls("Line32"), DataDynamics.ActiveReports.Line)
        Me.txtSS_KIN4 = CType(Me.GroupFooter1.Controls("txtSS_KIN4"), DataDynamics.ActiveReports.TextBox)
        Me.Line33 = CType(Me.GroupFooter1.Controls("Line33"), DataDynamics.ActiveReports.Line)
        Me.Line72 = CType(Me.GroupFooter1.Controls("Line72"), DataDynamics.ActiveReports.Line)
        Me.Line73 = CType(Me.GroupFooter1.Controls("Line73"), DataDynamics.ActiveReports.Line)
        Me.Line74 = CType(Me.GroupFooter1.Controls("Line74"), DataDynamics.ActiveReports.Line)
        Me.PageFooter = CType(Me.Sections("PageFooter"), DataDynamics.ActiveReports.PageFooter)
        Me.txtKAIS_NAME = CType(Me.PageFooter.Controls("txtKAIS_NAME"), DataDynamics.ActiveReports.TextBox)
        Me.txtPAGE_NO = CType(Me.PageFooter.Controls("txtPAGE_NO"), DataDynamics.ActiveReports.ReportInfo)
        Me.lblOTHERS = CType(Me.PageFooter.Controls("lblOTHERS"), DataDynamics.ActiveReports.TextBox)
        Me.ReportFooter = CType(Me.Sections("ReportFooter"), DataDynamics.ActiveReports.ReportFooter)

    End Sub

#End Region

#Region "帳票出力条件取得"

    ''' <summary>
    ''' 帳票出力条件取得
    ''' </summary>
    ''' <remarks>共通問合せ画面で指定された条件を取得</remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub getParam(ByVal pParameterNo As Decimal)

        Dim dsParam As New DataSet
        Dim xSqlTxt As String = String.Empty
        Dim xml As String = String.Empty

        Try
            'XML展開用（SQL条件）
            Dim dsXmlSql As New DataSet

            'XML展開用（帳票出力項目）
            Dim dsXmlOut As New DataSet

            ''パラメータを取得
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT"
            xSqlTxt = xSqlTxt & vbCrLf & "		PRM.HEAD_CLOB		HEAD_CLOB"
            xSqlTxt = xSqlTxt & vbCrLf & ",     PRM.BODY_CLOB		BODY_CLOB"
            xSqlTxt = xSqlTxt & vbCrLf & ",     PRM.FREE_CLOB		FREE_CLOB"
            xSqlTxt = xSqlTxt & vbCrLf & "FROM"
            xSqlTxt = xSqlTxt & vbCrLf & "		W_PARAMETER		PRM"
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE"
            xSqlTxt = xSqlTxt & vbCrLf & "		PRM.PARAMETER_NO	=	" & fSqlStr(pParameterNo, BrowsefSqlStr.fSqlStr_Decimal)

            ''SQLの実行
            dsParam = wsCommon.GetDBString("BaseDBController", xSqlTxt)

            ''データがない場合はエラーとする
            If IsNothing(dsParam) Then
                Throw New Exception("パラメータの検索に失敗しました")
            ElseIf dsParam.Tables(0).Rows.Count < 1 Then
                Throw New Exception("パラメータ番号=" & pParameterNo & "のデータがありません")
            End If

            'XMLをデータセットに展開
            xml = fToText(dsParam.Tables(0).Rows(0).Item("FREE_CLOB"))
            If xml <> String.Empty Then
                dsXmlSql.ReadXml(New IO.StringReader(xml))
            End If

            xml = fToText(dsParam.Tables(0).Rows(0).Item("HEAD_CLOB"))
            If xml <> String.Empty Then
                dsXmlOut.ReadXml(New IO.StringReader(xml))
            End If

            With Hensu.param
                ''アクション
                .pAction = fToInt(dsXmlOut.Tables(0).Rows(0).Item("ACT"))

                .pReportCode = ProgramCode

                ''帳票タイトル
                .pReportTitle = fToText(dsXmlOut.Tables(0).Rows(0).Item("REPORT_TITLE"))

                .pDateFrom = fToDate(dsXmlOut.Tables(0).Rows(0).Item("DATE_FROM"))
                .pDateTo = fToDate(dsXmlOut.Tables(0).Rows(0).Item("DATE_TO"))

                .pOrderOpt = fToInt(dsXmlOut.Tables(0).Rows(0).Item("ORDER_OPT"))
                .pSimeDate = fToInt(dsXmlOut.Tables(0).Rows(0).Item("SIME_DATE"))
                .pKanseiOpt = fToInt(dsXmlOut.Tables(0).Rows(0).Item("KANSEI_OPT"))
                
                ''帳票コード印刷
                .pReportPrint = fToInt(dsXmlOut.Tables(0).Rows(0).Item("REPORT_PRINT"))

                ''会社コード印刷
                .pKaisPrint = fToInt(dsXmlOut.Tables(0).Rows(0).Item("KAIS_PRINT"))

                ''システム日付印刷
                .pSysDatePrint = fToInt(dsXmlOut.Tables(0).Rows(0).Item("SYSDATE_PRINT"))

                ''SQL文条件句用
                For Each row As DataRow In dsXmlSql.Tables(0).Rows
                    Select Case fToText(row.Item("KEY"))
                        Case "@KAIS_CHK@"
                            .pKaisChk = fToInt(row.Item("Value"))
                        Case "@KAIS_DOM@"
                            .pKaisDom = fToText(row.Item("Value"))
                        Case "@KAIS_FROM@"
                            .pKaisFrom = fToInt(row.Item("Value"))
                        Case "@KAIS_TO@"
                            .pKaisTo = fToInt(row.Item("Value"))
                        Case "@BMN_KAISOU_CHK@"
                            .pBmnKaisouChk = fToInt(row.Item("Value"))
                        Case "@BMN_KAISOU@"
                            .pBmnKaisou = fToInt(row.Item("Value"))
                        Case "@BMN_UW_CHK@"
                            .pBmnUwChk = fToInt(row.Item("Value"))
                        Case "@BMN_UW_DOM@"
                            .pBmnUwDom = fToText(row.Item("Value"))
                        Case "@TOR_CHK@"
                            .pTorChk = fToInt(row.Item("Value"))
                        Case "@TOR_DOM@"
                            .pTorDom = fToText(row.Item("Value"))
                        Case "@KOJ_SHUKEI_OPT@"
                            .pKojShukeOpt = fToInt(row.Item("Value"))
                        Case "@KANSEI_OPT@"
                            .pKanseiOpt = fToInt(row.Item("Value"))
                        Case "@KOJ_CHK@"
                            .pKojChk = fToInt(row.Item("Value"))
                        Case "@KOJ_DOM@"
                            .pKojDom = fToText(row.Item("Value"))
                        Case "@KOJ_UW_CHK@"
                            .pKojUwChk = fToInt(row.Item("Value"))
                        Case "@KOJ_UW_DOM@"
                            .pKojUwDom = fToText(row.Item("Value"))
                        Case "@EIGYO_TANT_CHK@"
                            .pEigyoTantChk = fToInt(row.Item("Value"))
                        Case "@EIGYO_TANT_DOM@"
                            .pEigyoTantDom = fToText(row.Item("Value"))
                        Case "@DATE_DOM@"
                            .pDateDom = fToText(row.Item("Value"))

                    End Select
                Next
            End With

        Catch ex As Exception
            Throw New Exception("帳票出力条件取得に失敗しました 詳細:" & ex.Message)
        End Try

    End Sub

#End Region

#Region "帳票出力条件削除"

    ''' <summary>
    ''' 帳票出力条件削除
    ''' </summary>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub deleteParam(ByVal pParameterNo As Decimal)
#If Not Debug Then
        Dim xSqlTxt As String = String.Empty

        Try
            xSqlTxt = xSqlTxt & vbCrLf & " DELETE"
            xSqlTxt = xSqlTxt & vbCrLf & " FROM"
            xSqlTxt = xSqlTxt & vbCrLf & "		W_PARAMETER		PRM"
            xSqlTxt = xSqlTxt & vbCrLf & " WHERE"
            xSqlTxt = xSqlTxt & vbCrLf & "		PRM.PARAMETER_NO	=	" & fSqlStr(pParameterNo, BrowsefSqlStr.fSqlStr_Decimal)

            ''SQLの実行
            wsCommon.ExecuteSQLCommand("BaseDBController", xSqlTxt)

        Catch ex As Exception
            '' 例外は再スロー
            Throw ex
        End Try
#End If

    End Sub

#End Region

#Region "プログラム情報取得"

    ''' <summary>
    ''' プログラム情報取得
    ''' </summary>
    ''' <remarks>帳票ヘッダ部出力項目および制御用項目を取得</remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub getProgram()

        Dim ds As New DataSet
        Dim xSqlTxt As String = String.Empty

        Try
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT"
            xSqlTxt = xSqlTxt & vbCrLf & "		PRG.NAME			NAME"
            xSqlTxt = xSqlTxt & vbCrLf & ",     PRG.DOCNO			DOCNO"
            xSqlTxt = xSqlTxt & vbCrLf & ",     PRG.GYO_LMAX_KMK	GYO_LMAX_KMK"
            xSqlTxt = xSqlTxt & vbCrLf & "FROM"
            xSqlTxt = xSqlTxt & vbCrLf & "		M_PROGRAM	PRG"
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE"
            xSqlTxt = xSqlTxt & vbCrLf & "		PRG.CODE	=	" & fSqlStr(ProgramCode, BrowsefSqlStr.fSqlStr_Integer)

            'SQLの実行
            ds = wsCommon.GetDBString("BaseDBController", xSqlTxt)

            'データがない場合はエラーとする
            If IsNothing(ds) Then
                Throw New Exception("プログラム情報の取得に失敗しました")
            ElseIf ds.Tables(0).Rows.Count < 1 Then
                Throw New Exception("プログラム情報の取得に失敗しました")
            End If

            ReportTitle = fToText(ds.Tables(0).Rows(0).Item("NAME"))
            DocNo = fToText(ds.Tables(0).Rows(0).Item("DOCNO"))

        Catch ex As Exception
            Throw ex
        End Try

    End Sub

#End Region

#Region "レポート設定用情報取得"

    ''' <summary>
    ''' レポート設定用情報取得
    ''' </summary>
    ''' <remarks>レポート（用紙）設定用情報を取得</remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Function getProperty() As DataRow

        Dim ds As New DataSet
        Dim xSqlTxt As String = String.Empty

        Try
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT"
            xSqlTxt = xSqlTxt & vbCrLf & "		PRP.USER_NO				USER_NO"                '010 ユーザーコード
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PROGRAM_CODE		PROGRAM_CODE"           '020 プログラムコード
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.CODE				CODE"                   '030 コード
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.NAME				NAME"                   '040 名称
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.COL_COUNT			COL_COUNT"              '050 列数
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.GMN_TOP			GMN_TOP"                '060 上位置
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.GMN_LEFT			GMN_LEFT"               '070 左位置
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.GMN_HEIGHT			GMN_HEIGHT"             '080 高さ
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.GMN_WIDTH			GMN_WIDTH"              '090 幅
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.GMN_ROWHEIGHT		GMN_ROWHEIGHT"          '100 行高
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.GMN_WITH_KBN		GMN_WITH_KBN"           '110 グループ表示
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.GMN_TREE_KBN		GMN_TREE_KBN"           '120 ツリー表示
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.GMN_KOTEI			GMN_KOTEI"              '130 固定列
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.GMN_BACKCOLOR1		GMN_BACKCOLOR1"         '140 背景色
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.GMN_BACKCOLOR2		GMN_BACKCOLOR2"         '150 背景色
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.GMN_TOTALPOS		GMN_TOTALPOS"           '160 合計行位置
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.RPT_PRINTER		RPT_PRINTER"            '170 プリンター
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.RPT_PAPER			RPT_PAPER"              '180 用紙サイズ
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.RPT_PAPER_HEIGHT	RPT_PAPER_HEIGHT"       '190 用紙高
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.RPT_PAPER_WIDTH	RPT_PAPER_WIDTH"        '200 用紙幅
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.RPT_ORIENTATION	RPT_ORIENTATION"        '210 用紙縦横
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.RPT_PAPER_SOURCE	RPT_PAPER_SOURCE"       '220 給紙方法
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.RPT_DUPLEX			RPT_DUPLEX"             '230 両面印刷
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.RPT_TOP			RPT_TOP"                '240 上余白
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.RPT_BOTTOM			RPT_BOTTOM"             '250 下余白
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.RPT_LEFT			RPT_LEFT"               '260 左余白
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.RPT_RIGHT			RPT_RIGHT"              '270 右余白
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_TOTALPOS		PRT_TOTALPOS"           '280 合計行位置
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_PTN		PRT_HEAD_PTN"           '290 ヘッダパターン
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY1		PRT_HEAD_KEY1"          '300 ヘッダパターン条件１
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY2		PRT_HEAD_KEY2"          '310 ヘッダパターン条件２
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY3		PRT_HEAD_KEY3"          '320 ヘッダパターン条件３
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY4		PRT_HEAD_KEY4"          '330 ヘッダパターン条件４
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY5		PRT_HEAD_KEY5"          '340 ヘッダパターン条件５
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY6		PRT_HEAD_KEY6"          '350 ヘッダパターン条件６
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY7		PRT_HEAD_KEY7"          '360 ヘッダパターン条件７
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY8		PRT_HEAD_KEY8"          '370 ヘッダパターン条件８
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY9		PRT_HEAD_KEY9"          '380 ヘッダパターン条件９
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY10		PRT_HEAD_KEY10"         '390 ヘッダパターン条件１０
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY11		PRT_HEAD_KEY11"         '400 ヘッダパターン条件１１
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY12		PRT_HEAD_KEY12"         '410 ヘッダパターン条件１２
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY13		PRT_HEAD_KEY13"         '420 ヘッダパターン条件１３
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY14		PRT_HEAD_KEY14"         '430 ヘッダパターン条件１４
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY15		PRT_HEAD_KEY15"         '440 ヘッダパターン条件１５
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY16		PRT_HEAD_KEY16"         '450 ヘッダパターン条件１６
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY17		PRT_HEAD_KEY17"         '460 ヘッダパターン条件１７
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY18		PRT_HEAD_KEY18"         '470 ヘッダパターン条件１８
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY19		PRT_HEAD_KEY19"         '480 ヘッダパターン条件１９
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY20		PRT_HEAD_KEY20"         '490 ヘッダパターン条件２０
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY21		PRT_HEAD_KEY21"         '500 ヘッダパターン条件２１
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY22		PRT_HEAD_KEY22"         '510 ヘッダパターン条件２２
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY23		PRT_HEAD_KEY23"         '520 ヘッダパターン条件２３
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY24		PRT_HEAD_KEY24"         '530 ヘッダパターン条件２４
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY25		PRT_HEAD_KEY25"         '540 ヘッダパターン条件２５
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY26		PRT_HEAD_KEY26"         '550 ヘッダパターン条件２６
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY27		PRT_HEAD_KEY27"         '560 ヘッダパターン条件２７
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY28		PRT_HEAD_KEY28"         '570 ヘッダパターン条件２８
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY29		PRT_HEAD_KEY29"         '580 ヘッダパターン条件２９
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.PRT_HEAD_KEY30		PRT_HEAD_KEY30"         '590 ヘッダパターン条件３０
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.RPT_EXCEL_PATH		RPT_EXCEL_PATH"         '600 ＥＸＣＥＬ保存パス
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.RPT_FILE_PATH		RPT_FILE_PATH"          '610 ＦＩＬＥ保存パス
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.DEFAULT_KBN		DEFAULT_KBN"            '620 初期設定区分
            '                                                                                   '630 汎用
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.RIREKI_NO			RIREKI_NO"              '640 履歴番号
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.RIREKI_INDEX		RIREKI_INDEX"           '650 履歴変更番号
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.UD_DATE			UD_DATE"                '660 修正年月日
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.AD_DATE			AD_DATE"                '670 発生年月日
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.OPID				OPID"                   '680 ＯＰＩＤ
            xSqlTxt = xSqlTxt & vbCrLf & "		,PRP.UD_USER			UD_USER"                '690 更新者コード
            xSqlTxt = xSqlTxt & vbCrLf & "FROM"
            xSqlTxt = xSqlTxt & vbCrLf & "		T_PROPERTY		PRP"
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE"
            xSqlTxt = xSqlTxt & vbCrLf & "		PRP.USER_NO			=	" & fSqlStr(SysUserNo, BrowsefSqlStr.fSqlStr_Integer)
            xSqlTxt = xSqlTxt & vbCrLf & "	AND	PRP.PROGRAM_CODE	=	" & fSqlStr(ProgramCode, BrowsefSqlStr.fSqlStr_Integer)

            'SQLの実行

            ds = wsCommon.GetDBString("BaseDBController", xSqlTxt)

            'データがない場合はエラーとする
            If IsNothing(ds) Then
                Throw New Exception("レポート設定情報の取得に失敗しました")
            ElseIf ds.Tables(0).Rows.Count < 1 Then
                Throw New Exception(cstErrNoSettingData)
            End If

            Return ds.Tables(0).Rows(0)

        Catch ex As Exception
            Throw ex
            Return Nothing
        End Try

    End Function

#End Region

#Region "SQL生成"

    ''' <summary>
    ''' テーブル構造を作成する 
    ''' </summary>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub DataSetSetting()

        '' グリッド表示用データセット生成
        Hensu.dSReport = New DataSet

        ''W_TUKIBETUSEIK
        Hensu.dSReport.Tables.Add(Hensu.W_TUKIBETUSEIK)

        With Hensu.dSReport.Tables(Hensu.W_TUKIBETUSEIK)

            '' カラム定義
            .Columns.Add("KAIS", GetType(Integer))
            .Columns.Add("KAIS_NAME", GetType(String))
            .Columns.Add("BMN_UW", GetType(String))
            .Columns.Add("BMN_UW_NAME", GetType(String))
            .Columns.Add("SEIK", GetType(String))
            .Columns.Add("SEIK_RYAKU", GetType(String))
            .Columns.Add("SEIK_KANA", GetType(String))
            .Columns.Add("SEIK_NAME", GetType(String))

            .Columns.Add("KAISYU_KBN", GetType(Integer))
            .Columns.Add("SIME_HACH", GetType(Integer))
            .Columns.Add("KAISYU", GetType(Integer))
            .Columns.Add("KAISYU_KIN_RITU", GetType(Decimal))
            .Columns.Add("KAISYU_TEG_RITU", GetType(Decimal))
            .Columns.Add("KAISYU_TEG_SAIT", GetType(Decimal))
            .Columns.Add("HORYU_RITU", GetType(Decimal))
            .Columns.Add("HANBAI_SW", GetType(Integer))
            .Columns.Add("KOJ", GetType(String))
            .Columns.Add("KOJ_NAME", GetType(String))
            .Columns.Add("KOJ_UW", GetType(String))
            .Columns.Add("KOJ_UW_NAME", GetType(String))

            .Columns.Add("HACH", GetType(String))
            .Columns.Add("HACH_NAME", GetType(String))
            .Columns.Add("OTHERS", GetType(String))
            .Columns.Add("KOUHOU", GetType(String))
            .Columns.Add("KOUHOU_NAME", GetType(String))
            .Columns.Add("EIGYO_TANT_NAME", GetType(String))
            .Columns.Add("KOJ_TANT_NAME", GetType(String))

            .Columns.Add("SYUNKO", GetType(Date))
            .Columns.Add("KAN_FURI", GetType(Date))

            .Columns.Add("KEIY_KIN", GetType(Decimal))
            .Columns.Add("ZEI_KIN", GetType(Decimal))
            .Columns.Add("SEIK_T_KIN", GetType(Decimal))
            .Columns.Add("ZEN_NYU_KIN", GetType(Decimal))
            .Columns.Add("TOU_NYUK_YOTEI_KIN", GetType(Decimal))
            .Columns.Add("TOU_SEIK_YOTEI_KIN", GetType(Decimal))
            .Columns.Add("T_NYU_KIN", GetType(Decimal))
            .Columns.Add("T_SEI_KIN", GetType(Decimal))
            .Columns.Add("SEIK_KIN", GetType(Decimal))
            .Columns.Add("SEIK_ZEI", GetType(Decimal))
            .Columns.Add("NYU_KIN", GetType(Decimal))
            .Columns.Add("N1MSEIK_KIN", GetType(Decimal))
            .Columns.Add("N1MSEIK_ZEI", GetType(Decimal))       ''N月迄請求金額 内税金
            .Columns.Add("N1MSEIK_Y_KIN", GetType(Decimal))
            .Columns.Add("N1MNYU_KIN", GetType(Decimal))
            .Columns.Add("NSEIK_KIN", GetType(Decimal))
            .Columns.Add("NSEIK_ZEI", GetType(Decimal))
            .Columns.Add("NSEIK_Y_KIN", GetType(Decimal))
            .Columns.Add("NNYU_KIN", GetType(Decimal))
            For i As Integer = 1 To 5
                .Columns.Add("N" & i & "SEIK_KIN", GetType(Decimal))
                .Columns.Add("N" & i & "SEIK_ZEI", GetType(Decimal))    ''N+i月請求金額 内税金
                .Columns.Add("N" & i & "SEIK_Y_KIN", GetType(Decimal))
                .Columns.Add("N" & i & "NYU_KIN", GetType(Decimal))
            Next i
            .Columns.Add("N5MSEIK_KIN", GetType(Decimal))
            .Columns.Add("N5MSEIK_ZEI", GetType(Decimal))               ''N+5月迄請求金額 内税金
            .Columns.Add("N5MSEIK_Y_KIN", GetType(Decimal))
            .Columns.Add("N5MNYU_KIN", GetType(Decimal))
            .Columns.Add("URI_KIN", GetType(Decimal))
            .Columns.Add("NRSEIK_KIN", GetType(Decimal))
            .Columns.Add("NRNYU_KIN", GetType(Decimal))
            For i As Integer = 1 To 5
                .Columns.Add("NR" & i & "SEIK_KIN", GetType(Decimal))
                .Columns.Add("NR" & i & "NYU_KIN", GetType(Decimal))
            Next i

            ''追加列 
            .Columns.Add("NMSEIK_NYU_ZAN", GetType(Decimal))
            .Columns.Add("NRSEIK_NYU_ZAN", GetType(Decimal))
            For i As Integer = 1 To 5
                .Columns.Add("NR" & i & "SEIK_NYU_ZAN", GetType(Decimal))
            Next i
            .Columns.Add("N5MSEIK_NYU_ZAN", GetType(Decimal))

        End With

        ''帳票データ 
        Hensu.dSReport.Tables.Add("REPORT")

        With Hensu.dSReport.Tables("REPORT")

            '' カラム定義
            .Columns.Add("KAIS", GetType(Integer))
            .Columns.Add("KAIS_NAME", GetType(String))
            .Columns.Add("BMN_UW", GetType(String))
            .Columns.Add("BMN_UW_NAME", GetType(String))
            .Columns.Add("SEIK", GetType(String))
            .Columns.Add("SEIK_RYAKU", GetType(String))
            .Columns.Add("SEIK_KANA", GetType(String))
            .Columns.Add("SEIK_NAME", GetType(String))
            .Columns.Add("KAISYU_KBN", GetType(Integer))
            .Columns.Add("SIME_HACH", GetType(Integer))
            .Columns.Add("KAISYU", GetType(String))
            .Columns.Add("KAISYU_KIN_RITU", GetType(Decimal))
            .Columns.Add("KAISYU_TEG_RITU", GetType(Decimal))
            .Columns.Add("KAISYU_TEG_SAIT", GetType(Decimal))
            .Columns.Add("HORYU_RITU", GetType(Decimal))
            .Columns.Add("HANBAI_SW", GetType(Integer))
            .Columns.Add("KOJ", GetType(String))
            .Columns.Add("KOJ_UW", GetType(String))
            .Columns.Add("KOJ_NAME", GetType(String))
            .Columns.Add("HACH", GetType(String))
            .Columns.Add("HACH_NAME", GetType(String))
            .Columns.Add("OTHERS", GetType(String))
            .Columns.Add("KOUHOU", GetType(String))
            .Columns.Add("KOUHOU_NAME", GetType(String))
            .Columns.Add("EIGYO_TANT_NAME", GetType(String))
            .Columns.Add("KOJ_TANT_NAME", GetType(String))
            .Columns.Add("SYUNKO", GetType(Date))
            .Columns.Add("KAN_FURI", GetType(Date))
            For i As Integer = 1 To 35
                .Columns.Add("KIN" & i, GetType(Decimal))
            Next i
            .Columns.Add("KIN26_ZEI", GetType(Decimal))
            For i As Integer = 1 To 8
                .Columns.Add("KIN_SZ" & i, GetType(Decimal))
            Next i
            .Columns.Add("MISEI_KIN", GetType(Decimal))

        End With

    End Sub

    ''' <summary>
    ''' データを取得しワークテーブルに挿入する 
    ''' </summary>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub GetDataToWork()
        Dim xSqlMain As String ''メインSQL
        Dim dsData As New DataSet
        Dim i As Integer
        Dim nBetMonths As Integer
        Dim nKin As Decimal
        Dim nZei As Decimal

        ''W_BMNテーブルのデータを削除する
        Me.DeleteW_BMN()

        ''データをW_BMNテーブルに追加する
        Me.InsertW_BMN()

        ''テーブル構造を作成する 
        Me.DataSetSetting()

        ''月間
        nBetMonths = fToInt(DateDiff("m", Hensu.param.pDateFrom, Hensu.param.pDateTo))

        ''請求情報取得
        xSqlMain = fSqlTxt_1()

        '' パラメータ変換
        xSqlMain = ReplaceParam(xSqlMain)

        '' 抽出実行
        dsData = wsCommon.GetDBString("BaseDBController", xSqlMain)

        '' データセットの初期化
        Hensu.dSReport.Tables(Hensu.W_TUKIBETUSEIK).Rows.Clear()

        '' 取得件数分ループ
        For Each dr As DataRow In dsData.Tables(0).Rows

            '' 新規行
            Dim NewRow As DataRow = Hensu.dSReport.Tables(Hensu.W_TUKIBETUSEIK).NewRow

            With NewRow

                .Item("KAIS") = fToInt(dr.Item("KAIS"))
                .Item("KAIS_NAME") = fToText(dr.Item("KAIS_NAME"))
                .Item("BMN_UW") = fToText(dr.Item("BMN_UW"))
                .Item("BMN_UW_NAME") = fToText(dr.Item("BMN_UW_NAME"))
                .Item("SEIK") = fToText(dr.Item("SEIK"))
                .Item("SEIK_RYAKU") = fToText(dr.Item("SEIK_RYAKU"))
                .Item("SEIK_KANA") = fToText(dr.Item("SEIK_KANA"))
                .Item("SEIK_NAME") = fToText(dr.Item("SEIK_NAME")) & fToText(dr.Item("SEIK_NAME2"))
                .Item("KAISYU_KBN") = fToInt(dr.Item("KAISYU_KBN"))
                .Item("SIME_HACH") = fToInt(dr.Item("SIME_HACH"))
                .Item("KAISYU") = fToInt(dr.Item("KAISYU"))
                .Item("KAISYU_KIN_RITU") = fToDec(dr.Item("KAISYU_KIN_RITU"))
                .Item("KAISYU_TEG_RITU") = fToDec(dr.Item("KAISYU_TEG_RITU"))
                .Item("KAISYU_TEG_SAIT") = fToDec(dr.Item("KAISYU_TEG_SAIT"))
                .Item("HORYU_RITU") = fToDec(dr.Item("HORYU_RITU"))
                .Item("HANBAI_SW") = fToDec(dr.Item("HANBAI_SW"))
                .Item("KOJ") = fToText(dr.Item("KOJ"))
                If Hensu.param.pKojShukeOpt = 2 Then
                    .Item("KOJ_UW") = fToText(dr.Item("KOJ_UW"))
                End If
                .Item("KOJ_NAME") = fToText(dr.Item("KOJ_NAME"))
                .Item("HACH") = fToText(dr.Item("HACH"))
                .Item("HACH_NAME") = fToText(dr.Item("HACH_NAME"))
                .Item("KOUHOU") = fToText(dr.Item("KOUHOU"))
                .Item("KOUHOU_NAME") = fToText(dr.Item("KOUHOU_NAME"))
                .Item("EIGYO_TANT_NAME") = fToText(dr.Item("EIGYO_TANT_NAME"))
                .Item("KOJ_TANT_NAME") = fToText(dr.Item("KOJ_TANT_NAME"))
                .Item("SYUNKO") = fToDate(dr.Item("SYUNKO"))
                .Item("KAN_FURI") = fToDate(dr.Item("KAN_FURI"))
                .Item("KEIY_KIN") = fToDec(dr.Item("KEIY_KIN"))
                .Item("ZEI_KIN") = fToDec(dr.Item("ZEI_KIN"))
                .Item("SEIK_T_KIN") = fToDec(dr.Item("KEIY_KIN")) + fToDec(dr.Item("ZEI_KIN"))
                .Item("ZEN_NYU_KIN") = 0
                .Item("TOU_NYUK_YOTEI_KIN") = 0
                .Item("TOU_SEIK_YOTEI_KIN") = 0
                .Item("T_NYU_KIN") = 0
                .Item("T_SEI_KIN") = fToDec(dr.Item("T_SEI_KIN"))
                .Item("SEIK_KIN") = fToDec(dr.Item("SEIK_KIN"))
                .Item("SEIK_ZEI") = fToDec(dr.Item("SEIK_ZEI"))
                .Item("NYU_KIN") = 0
                .Item("N1MSEIK_KIN") = fToDec(dr.Item("N1MSEIK_KIN"))
                .Item("N1MSEIK_ZEI") = fToDec(dr.Item("N1MSEIK_ZEI"))
                .Item("N1MSEIK_Y_KIN") = 0
                .Item("N1MNYU_KIN") = 0
                .Item("NSEIK_KIN") = fToDec(dr.Item("NSEIK_KIN"))
                .Item("NSEIK_ZEI") = fToDec(dr.Item("NSEIK_ZEI"))
                .Item("NSEIK_Y_KIN") = 0
                .Item("NNYU_KIN") = 0
                For i = 1 To 5
                    .Item("N" & i & "SEIK_KIN") = fToDec(dr.Item("N" & i & "SEIK_KIN"))
                    .Item("N" & i & "SEIK_ZEI") = fToDec(dr.Item("N" & i & "SEIK_ZEI"))
                    .Item("N" & i & "SEIK_Y_KIN") = 0
                    .Item("N" & i & "NYU_KIN") = 0
                Next i
                If nBetMonths = 0 Then
                    .Item("N5MSEIK_KIN") = fToDec(dr.Item("N1MSEIK_KIN")) + fToDec(dr.Item("NSEIK_KIN"))
                    .Item("N5MSEIK_ZEI") = fToDec(dr.Item("N1MSEIK_ZEI")) + fToDec(dr.Item("NSEIK_ZEI"))
                Else
                    nKin = 0
                    nZei = 0
                    For i = 1 To nBetMonths
                        nKin = nKin + fToDec(dr.Item("N" & i & "SEIK_KIN"))
                        nZei = nZei + fToDec(dr.Item("N" & i & "SEIK_ZEI"))
                    Next i
                    .Item("N5MSEIK_KIN") = fToDec(dr.Item("N1MSEIK_KIN")) + fToDec(dr.Item("NSEIK_KIN")) + nKin
                    .Item("N5MSEIK_ZEI") = fToDec(dr.Item("N1MSEIK_ZEI")) + fToDec(dr.Item("NSEIK_ZEI")) + nZei
                End If
                .Item("N5MSEIK_Y_KIN") = 0
                .Item("N5MNYU_KIN") = 0
                .Item("URI_KIN") = 0
                .Item("NRSEIK_KIN") = fToDec(dr.Item("NRSEIK_KIN"))
                .Item("NRNYU_KIN") = 0
                For i = 1 To 5
                    If i > nBetMonths Then
                        .Item("NR" & i & "SEIK_KIN") = 0
                    Else
                        .Item("NR" & i & "SEIK_KIN") = fToDec(dr.Item("NR" & i & "SEIK_KIN"))
                    End If
                    .Item("NR" & i & "NYU_KIN") = 0
                Next

            End With

            '' 行追加
            Hensu.dSReport.Tables(Hensu.W_TUKIBETUSEIK).Rows.Add(NewRow)
        Next

        ''予定書き込み
        xSqlMain = fSqlTxt_2()

        '' パラメータ変換
        xSqlMain = ReplaceParam(xSqlMain)

        '' 抽出実行
        dsData = wsCommon.GetDBString("BaseDBController", xSqlMain)

        '' 取得件数分ループ
        For Each dr As DataRow In dsData.Tables(0).Rows

            '' 新規行
            Dim NewRow As DataRow = Hensu.dSReport.Tables(Hensu.W_TUKIBETUSEIK).NewRow

            With NewRow

                .Item("KAIS") = fToInt(dr.Item("KAIS"))
                .Item("KAIS_NAME") = fToText(dr.Item("KAIS_NAME"))
                .Item("BMN_UW") = fToText(dr.Item("BMN_UW"))
                .Item("BMN_UW_NAME") = fToText(dr.Item("BMN_UW_NAME"))
                .Item("SEIK") = fToText(dr.Item("SEIK"))
                .Item("SEIK_RYAKU") = fToText(dr.Item("SEIK_RYAKU"))
                .Item("SEIK_KANA") = fToText(dr.Item("SEIK_KANA"))
                .Item("SEIK_NAME") = fToText(dr.Item("SEIK_NAME")) & fToText(dr.Item("SEIK_NAME2"))
                .Item("KAISYU_KBN") = fToInt(dr.Item("KAISYU_KBN"))
                .Item("SIME_HACH") = fToInt(dr.Item("SIME_HACH"))
                .Item("KAISYU") = fToInt(dr.Item("KAISYU"))
                .Item("KAISYU_KIN_RITU") = fToDec(dr.Item("KAISYU_KIN_RITU"))
                .Item("KAISYU_TEG_RITU") = fToDec(dr.Item("KAISYU_TEG_RITU"))
                .Item("KAISYU_TEG_SAIT") = fToDec(dr.Item("KAISYU_TEG_SAIT"))
                .Item("HORYU_RITU") = fToDec(dr.Item("HORYU_RITU"))
                .Item("HANBAI_SW") = fToInt(dr.Item("HANBAI_SW"))
                .Item("KOJ") = fToText(dr.Item("KOJ"))
                ''工事詳細指定時の工事複数対応
                If Hensu.param.pKojShukeOpt = 2 Then
                    .Item("KOJ_UW") = fToText(dr.Item("KOJ_UW"))
                End If
                .Item("KOJ_NAME") = fToText(dr.Item("KOJ_NAME"))
                .Item("HACH") = fToText(dr.Item("HACH"))
                .Item("HACH_NAME") = fToText(dr.Item("HACH_NAME"))
                .Item("KOUHOU") = fToText(dr.Item("KOUHOU"))
                .Item("KOUHOU_NAME") = fToText(dr.Item("KOUHOU_NAME"))
                .Item("EIGYO_TANT_NAME") = fToText(dr.Item("EIGYO_TANT_NAME"))
                .Item("KOJ_TANT_NAME") = fToText(dr.Item("KOJ_TANT_NAME"))
                .Item("SYUNKO") = fToDate(dr.Item("SYUNKO"))
                .Item("KAN_FURI") = fToDate(dr.Item("KAN_FURI"))
                .Item("KEIY_KIN") = fToDec(dr.Item("KEIY_KIN"))
                .Item("ZEI_KIN") = fToDec(dr.Item("ZEI_KIN"))
                .Item("SEIK_T_KIN") = fToDec(dr.Item("KEIY_KIN")) + fToDec(dr.Item("ZEI_KIN"))
                .Item("ZEN_NYU_KIN") = 0
                .Item("TOU_NYUK_YOTEI_KIN") = fToDec(dr.Item("TOU_NYUK_YOTEI_KIN"))
                .Item("TOU_SEIK_YOTEI_KIN") = fToDec(dr.Item("TOU_SEIK_YOTEI_KIN"))
                .Item("T_NYU_KIN") = 0
                .Item("T_SEI_KIN") = 0
                .Item("SEIK_KIN") = 0
                .Item("SEIK_ZEI") = 0
                .Item("NYU_KIN") = 0
                .Item("N1MSEIK_KIN") = 0
                .Item("N1MSEIK_ZEI") = 0
                .Item("N1MSEIK_Y_KIN") = fToDec(dr.Item("N1MSEIK_Y_KIN"))
                .Item("N1MNYU_KIN") = 0
                .Item("NSEIK_KIN") = 0
                .Item("NSEIK_ZEI") = 0
                .Item("NSEIK_Y_KIN") = fToDec(dr.Item("NSEIK_Y_KIN"))
                .Item("NNYU_KIN") = 0
                For i = 1 To 5
                    .Item("N" & i & "SEIK_KIN") = 0
                    .Item("N" & i & "SEIK_ZEI") = 0
                    .Item("N" & i & "SEIK_Y_KIN") = fToDec(dr.Item("N" & i & "SEIK_Y_KIN"))
                    .Item("N" & i & "NYU_KIN") = 0
                Next i
                If nBetMonths = 0 Then
                    .Item("N5MSEIK_Y_KIN") = fToDec(dr.Item("N1MSEIK_Y_KIN")) + fToDec(dr.Item("NSEIK_Y_KIN"))
                Else
                    nKin = 0
                    For i = 1 To nBetMonths
                        nKin = nKin + fToDec(dr.Item("N" & i & "SEIK_Y_KIN"))
                    Next i
                    .Item("N5MSEIK_Y_KIN") = fToDec(dr.Item("N1MSEIK_Y_KIN")) + fToDec(dr.Item("NSEIK_Y_KIN")) + nKin
                End If
                .Item("N5MSEIK_KIN") = 0
                .Item("N5MSEIK_ZEI") = 0
                .Item("N5MNYU_KIN") = 0
                .Item("URI_KIN") = 0
                .Item("NRSEIK_KIN") = 0
                .Item("NRNYU_KIN") = 0
                For i = 1 To 5
                    .Item("NR" & i & "SEIK_KIN") = 0
                    .Item("NR" & i & "NYU_KIN") = 0
                Next

            End With

            '' 行追加
            Hensu.dSReport.Tables(Hensu.W_TUKIBETUSEIK).Rows.Add(NewRow)
        Next

        ''入金書き込み
        xSqlMain = fSqlTxt_3()

        '' パラメータ変換
        xSqlMain = ReplaceParam(xSqlMain)

        '' 抽出実行
        dsData = wsCommon.GetDBString("BaseDBController", xSqlMain)

        '' 取得件数分ループ
        For Each dr As DataRow In dsData.Tables(0).Rows

            '' 新規行
            Dim NewRow As DataRow = Hensu.dSReport.Tables(Hensu.W_TUKIBETUSEIK).NewRow

            With NewRow
                .Item("KAIS") = fToInt(dr.Item("KAIS"))
                .Item("KAIS_NAME") = fToText(dr.Item("KAIS_NAME"))
                .Item("BMN_UW") = fToText(dr.Item("BMN_UW"))
                .Item("BMN_UW_NAME") = fToText(dr.Item("BMN_UW_NAME"))
                .Item("SEIK") = fToText(dr.Item("SEIK"))
                .Item("SEIK_RYAKU") = fToText(dr.Item("SEIK_RYAKU"))
                .Item("SEIK_KANA") = fToText(dr.Item("SEIK_KANA"))
                .Item("SEIK_NAME") = fToText(dr.Item("SEIK_NAME")) & fToText(dr.Item("SEIK_NAME2"))
                .Item("KAISYU_KBN") = fToInt(dr.Item("KAISYU_KBN"))
                .Item("SIME_HACH") = fToInt(dr.Item("SIME_HACH"))
                .Item("KAISYU") = fToInt(dr.Item("KAISYU"))
                .Item("KAISYU_KIN_RITU") = fToDec(dr.Item("KAISYU_KIN_RITU"))
                .Item("KAISYU_TEG_RITU") = fToDec(dr.Item("KAISYU_TEG_RITU"))
                .Item("KAISYU_TEG_SAIT") = fToDec(dr.Item("KAISYU_TEG_SAIT"))
                .Item("HORYU_RITU") = fToDec(dr.Item("HORYU_RITU"))
                .Item("HANBAI_SW") = fToInt(dr.Item("HANBAI_SW"))
                .Item("KOJ") = fToText(dr.Item("KOJ"))
                ''工事詳細指定時の工事複数対応
                If Hensu.param.pKojShukeOpt = 2 Then
                    .Item("KOJ_UW") = fToText(dr.Item("KOJ_UW"))
                End If
                .Item("KOJ_NAME") = fToText(dr.Item("KOJ_NAME"))
                .Item("HACH") = fToText(dr.Item("HACH"))
                .Item("HACH_NAME") = fToText(dr.Item("HACH_NAME"))
                .Item("KOUHOU") = fToText(dr.Item("KOUHOU"))
                .Item("KOUHOU_NAME") = fToText(dr.Item("KOUHOU_NAME"))
                .Item("EIGYO_TANT_NAME") = fToText(dr.Item("EIGYO_TANT_NAME"))
                .Item("KOJ_TANT_NAME") = fToText(dr.Item("KOJ_TANT_NAME"))
                .Item("SYUNKO") = fToDate(dr.Item("SYUNKO"))
                .Item("KAN_FURI") = fToDate(dr.Item("KAN_FURI"))
                .Item("KEIY_KIN") = fToDec(dr.Item("KEIY_KIN"))
                .Item("ZEI_KIN") = fToDec(dr.Item("ZEI_KIN"))
                .Item("SEIK_T_KIN") = fToDec(dr.Item("KEIY_KIN")) + fToDec(dr.Item("ZEI_KIN"))
                .Item("ZEN_NYU_KIN") = fToDec(dr.Item("ZEN_NYU_KIN"))
                .Item("TOU_NYUK_YOTEI_KIN") = 0
                .Item("TOU_SEIK_YOTEI_KIN") = 0
                .Item("T_NYU_KIN") = fToDec(dr.Item("T_NYU_KIN"))
                .Item("T_SEI_KIN") = 0
                .Item("SEIK_KIN") = 0
                .Item("SEIK_ZEI") = 0
                .Item("NYU_KIN") = fToDec(dr.Item("NYU_KIN"))
                .Item("N1MSEIK_KIN") = 0
                .Item("N1MSEIK_ZEI") = 0
                .Item("N1MSEIK_Y_KIN") = 0
                .Item("N1MNYU_KIN") = fToDec(dr.Item("N1MNYU_KIN"))
                .Item("NSEIK_KIN") = 0
                .Item("NSEIK_ZEI") = 0
                .Item("NSEIK_Y_KIN") = 0
                .Item("NNYU_KIN") = fToDec(dr.Item("NNYU_KIN"))
                For i = 1 To 5
                    .Item("N" & i & "SEIK_KIN") = 0
                    .Item("N" & i & "SEIK_ZEI") = 0
                    .Item("N" & i & "SEIK_Y_KIN") = 0
                    .Item("N" & i & "NYU_KIN") = fToDec(dr.Item("N" & i & "NYU_KIN"))
                Next i
                If nBetMonths = 0 Then
                    .Item("N5MNYU_KIN") = fToDec(dr.Item("N1MNYU_KIN")) + fToDec(dr.Item("NNYU_KIN"))
                Else
                    nKin = 0
                    For i = 1 To nBetMonths
                        nKin = nKin + fToDec(dr.Item("N" & i & "NYU_KIN"))
                    Next i
                    .Item("N5MNYU_KIN") = fToDec(dr.Item("N1MNYU_KIN")) + fToDec(dr.Item("NNYU_KIN")) + nKin
                End If
                .Item("N5MSEIK_KIN") = 0
                .Item("N5MSEIK_ZEI") = 0
                .Item("N5MSEIK_Y_KIN") = 0
                .Item("URI_KIN") = 0
                .Item("NRSEIK_KIN") = 0
                .Item("NRNYU_KIN") = fToDec(dr.Item("NRNYU_KIN"))
                For i = 1 To 5
                    .Item("NR" & i & "SEIK_KIN") = 0
                    If i > nBetMonths Then
                        .Item("NR" & i & "NYU_KIN") = 0
                    Else
                        .Item("NR" & i & "NYU_KIN") = fToDec(dr.Item("NR" & i & "NYU_KIN"))
                    End If
                Next
            End With

            '' 行追加
            Hensu.dSReport.Tables(Hensu.W_TUKIBETUSEIK).Rows.Add(NewRow)
        Next

        ''売上
        xSqlMain = fSqlTxt_4()

        '' パラメータ変換
        xSqlMain = ReplaceParam(xSqlMain)

        '' 抽出実行
        dsData = wsCommon.GetDBString("BaseDBController", xSqlMain)

        '' 取得件数分ループ
        ''KOJ、KOJ_UWごとにURI_KINを更新する 
        Dim xFilter As String = String.Empty
        Dim xKoj As String = String.Empty
        Dim xKojUw As String = String.Empty

        For Each dr As DataRow In dsData.Tables(0).Rows
            xKoj = fToText(dr.Item("KOJ"))

            If Hensu.param.pKojShukeOpt = 1 Then
                xFilter = " KOJ = " & fDtSqlStr(xKoj, BrowsefSqlStr.fSqlStr_Text)
                For Each drUriKin As DataRow In Hensu.dSReport.Tables(Hensu.W_TUKIBETUSEIK).Select(xFilter, "", DataViewRowState.CurrentRows)
                    drUriKin.Item("URI_KIN") = dr.Item("URI_KIN")
                Next
            Else
                xKojUw = fToText(dr.Item("KOJ_UW"))
                xFilter = " KOJ = " & fDtSqlStr(xKoj, BrowsefSqlStr.fSqlStr_Text)
                xFilter = xFilter & " AND KOJ_UW = " & fDtSqlStr(xKojUw, BrowsefSqlStr.fSqlStr_Text)
                For Each drUriKin As DataRow In Hensu.dSReport.Tables(Hensu.W_TUKIBETUSEIK).Select(xFilter, "", DataViewRowState.CurrentRows)
                    drUriKin.Item("URI_KIN") = dr.Item("URI_KIN")
                Next
            End If
        Next
    End Sub

    ''' <summary>
    ''' 元SQLを持ってくる
    ''' </summary>
    ''' <returns>SQL文</returns>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Function fSqlTxt_1() As String
        Dim xSqlTxt As String

        If Hensu.param.pKojShukeOpt = 1 Then

            xSqlTxt = ""
            ''通常工事
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "		KOJ.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.T_SEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1MSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1MSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NRSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N2SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N3SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N4SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N5SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		0 HANBAI_SW "



            xSqlTxt = xSqlTxt & vbCrLf & "FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "		(SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "				KOJ.KAIS KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KAI.RYAKU   KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.BMN_UW BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		BMN.RYAKU   BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.SEIK SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.RYAKU SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KANA  SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.NAME  SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.NAME2 SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.CODE KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.RYAKU KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.HACH HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TO2.RYAKU       HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.YOBI_CODE2	 KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		MEI.RYAKU	   KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TAE.NAME	   EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TAK.NAME	   KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KEIY_KIN + KOJ.KEIY_KIN_HEN KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.ZEI_KIN	 + KOJ.ZEI_KIN_HEN  ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "				M_KOJ		KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		M_KAIS		KAI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		M_BMN_UW    BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		M_TANT		TAE "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		M_TANT		TAK "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		V_HACH		TOR "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		M_TOR		TO2 "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		(SELECT CODE, RYAKU FROM M_MEI WHERE MKBN = 3207600) MEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "				(KOJ.CODE <> KOJ.BMN_UW) "
            If Hensu.param.pKaisChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KOJ.KAIS		@KAIS_DOM@ "
            End If
            If Hensu.param.pKojChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KOJ.CODE		@KOJ_DOM@ "
            End If
            If Hensu.param.pTorChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KOJ.SEIK		@TOR_DOM@ "
            End If
            If Hensu.param.pEigyoTantChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KOJ.EIGYO_TANT  @EIGYO_TANT_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		KOJ.BMN_UW  IN "
            xSqlTxt = xSqlTxt & vbCrLf & "                      (SELECT BMN_UW FROM W_BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "                      WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "                              @SYSUSERNO@     = USER_NO "
            xSqlTxt = xSqlTxt & vbCrLf & "                      AND     @SESSION_ID@    = SESSION_ID "
            xSqlTxt = xSqlTxt & vbCrLf & "                      AND     @PROGRAM_CODE@  = PROGRAM_CODE) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KOJ.SEIK = TOR.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KOJ.YOBI_CODE2 = MEI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KOJ.KAIS       = KAI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KOJ.BMN_UW     = BMN.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KOJ.EIGYO_TANT = TAE.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KOJ.KOJ_TANT = TAK.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KOJ.HACH       = TO2.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KOJ.NYU_KANRI_KBN =0)"
            xSqlTxt = xSqlTxt & vbCrLf & "		)		KOJ"
            xSqlTxt = xSqlTxt & vbCrLf & ",		(SELECT	 "
            xSqlTxt = xSqlTxt & vbCrLf & "				SEK.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SEK.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(NVL(SEK.KIN,0)) SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(NVL(SEK.U_ZEI,0)) SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(FUN_IIFDATE(SEK.SEIK_DATE,'>=',@START_DDATE_FROM_SIME@,FUN_IIFDATE(SEIK_DATE,'<=',@END_DDATE_TO_SIME@,NVL(KIN,0),0),0)) T_SEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1),NVL(KIN,0),0))) N1MSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1),NVL(U_ZEI,0),0))) N1MSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',@START_DDATE_FROM_1@,NVL(KIN,0),0)))				  NRSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(KIN,0),0))) NR1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(KIN,0),0))) NR2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(KIN,0),0))) NR3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(KIN,0),0))) NR4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(KIN,0),0))) NR5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@,NVL(KIN,0),0))) NSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(KIN,0),0))) N1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(KIN,0),0))) N2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(KIN,0),0))) N3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(KIN,0),0))) N4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(KIN,0),0))) N5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@,NVL(U_ZEI,0),0))) NSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(U_ZEI,0),0))) N1SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(U_ZEI,0),0))) N2SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(U_ZEI,0),0))) N3SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(U_ZEI,0),0))) N4SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(U_ZEI,0),0))) N5SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "				D_SEIK      SEK "
            xSqlTxt = xSqlTxt & vbCrLf & "		GROUP BY  "
            xSqlTxt = xSqlTxt & vbCrLf & "				KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ)		SUB "
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "		(KOJ.KAIS = SUB.KAIS(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(KOJ.KOJ  = SUB.KOJ(+)) "













            xSqlTxt = xSqlTxt & vbCrLf & "UNION "
            ''販売工事
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "		KOJ.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.T_SEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1MSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1MSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NRSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N2SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N3SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N4SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N5SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		1		HANBAI_SW "
            xSqlTxt = xSqlTxt & vbCrLf & "FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "		(SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "				KOJ.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KEI.KEIY SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.RYAKU SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KANA  SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.NAME  SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.NAME2 SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "				F_KEIYAKU	KEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		V_HACH		TOR "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		(SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "						KOJ.KAIS KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KAI.RYAKU KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KOJ.BMN_UW BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		BMN.RYAKU   BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KOJ.CODE KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KOJ.RYAKU KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KOJ.HACH HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		TOR.RYAKU   HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KOJ.YOBI_CODE2	 KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		MEI.RYAKU	   KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		TAE.NAME	   EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		TAK.NAME	   KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KOJ.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KOJ.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KOJ.KEIY_KIN + KOJ.KEIY_KIN_HEN KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KOJ.ZEI_KIN	 + KOJ.ZEI_KIN_HEN  ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "				FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "						M_KOJ		KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		M_KAIS		KAI "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		M_BMN_UW	BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		M_TOR		TOR "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		M_TANT		TAE "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		M_TANT		TAK "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		(SELECT CODE, RYAKU FROM M_MEI WHERE MKBN = 3207600) MEI "
            xSqlTxt = xSqlTxt & vbCrLf & "				WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "						(KOJ.CODE = KOJ.BMN_UW) "
            If Hensu.param.pKaisChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		KOJ.KAIS      @KAIS_DOM@ "
            End If
            If Hensu.param.pKojChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		KOJ.CODE      @KOJ_DOM@ "
            End If
            If Hensu.param.pEigyoTantChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		KOJ.EIGYO_TANT  @EIGYO_TANT_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		KOJ.BMN_UW  IN "
            xSqlTxt = xSqlTxt & vbCrLf & "              		        (SELECT BMN_UW FROM W_BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "              		        WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "              		                @SYSUSERNO@     = USER_NO "
            xSqlTxt = xSqlTxt & vbCrLf & "              		        AND     @SESSION_ID@    = SESSION_ID "
            xSqlTxt = xSqlTxt & vbCrLf & "               		        AND     @PROGRAM_CODE@  = PROGRAM_CODE) "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		(KOJ.KAIS       = KAI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		(KOJ.BMN_UW     = BMN.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		(KOJ.HACH       = TOR.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		(KOJ.YOBI_CODE2 = MEI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		(KOJ.EIGYO_TANT = TAE.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		(KOJ.KOJ_TANT = TAK.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		(KOJ.NYU_KANRI_KBN =0) "
            xSqlTxt = xSqlTxt & vbCrLf & "				)		KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "		WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "				1               =   1 "
            If Hensu.param.pTorChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KEI.KEIY      @TOR_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KEI.KAIS		=	KOJ.KAIS) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KEI.BMN_UW		=	KOJ.KOJ) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KEI.KEIY		=	TOR.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		)		KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",		(SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "				SEK.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SEK.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SEK.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(NVL(KIN,0)) SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(NVL(U_ZEI,0)) SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(FUN_IIFDATE(SEIK_DATE,'>=',@START_DDATE_FROM_SIME@,FUN_IIFDATE(SEIK_DATE,'<=',@END_DDATE_TO_SIME@,NVL(KIN,0),0),0)) T_SEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1),NVL(KIN,0),0))) N1MSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1),NVL(U_ZEI,0),0))) N1MSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',@START_DDATE_FROM_1@,NVL(KIN,0),0)))				NRSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(KIN,0),0))) NR1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(KIN,0),0))) NR2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(KIN,0),0))) NR3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(KIN,0),0))) NR4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(KIN,0),0))) NR5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@,NVL(KIN,0),0))) NSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(KIN,0),0))) N1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(KIN,0),0))) N2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(KIN,0),0))) N3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(KIN,0),0))) N4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(KIN,0),0))) N5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@,NVL(U_ZEI,0),0))) NSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(U_ZEI,0),0))) N1SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(U_ZEI,0),0))) N2SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(U_ZEI,0),0))) N3SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(U_ZEI,0),0))) N4SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(U_ZEI,0),0))) N5SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "				D_SEIK		SEK "
            xSqlTxt = xSqlTxt & vbCrLf & "		GROUP BY "
            xSqlTxt = xSqlTxt & vbCrLf & "				SEK.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SEK.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SEK.SEIK)		SUB "
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "			(KOJ.KAIS = SUB.KAIS(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND		(KOJ.KOJ	 = SUB.KOJ(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND		(KOJ.SEIK = SUB.SEIK(+)) "
        Else
            xSqlTxt = ""
            ''通常工事
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "		KOJ.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.T_SEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1MSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1MSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NRSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N2SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N3SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N4SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N5SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		0		HANBAI_SW "
            xSqlTxt = xSqlTxt & vbCrLf & "FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "		(SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "				KOJ.KAIS KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KAI.RYAKU   KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KJU.BMN_UW  BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		BMN.RYAKU   BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KJU.SEIK SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.RYAKU SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KANA  SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.NAME  SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.NAME2 SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KJU.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KJU.CODE        KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KJU.RYAKU       KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KJU.HACH        HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TO2.RYAKU       HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KJU.YOBI_CODE2	 KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		MEI.RYAKU		 KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TAE.NAME		 EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TAK.NAME		 KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KJU.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KJU.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KJU.KEIY_KIN + KJU.KEIY_KIN_HEN KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KJU.ZEI_KIN  + KJU.ZEI_KIN_HEN	ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "				M_KOJ		KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		M_KOJ_UW	KJU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		M_KAIS  	KAI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		M_BMN_UW	BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		M_TOR   	TO2 "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		M_TANT		TAE "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		M_TANT		TAK "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		V_HACH		TOR "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		(SELECT CODE, RYAKU FROM M_MEI WHERE MKBN = 3207600) MEI "
            xSqlTxt = xSqlTxt & vbCrLf & "	    WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "				(KJU.KOJ <> KJU.BMN_UW) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KJU.KOJ = KOJ.CODE) "
            If Hensu.param.pKaisChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KOJ.KAIS		@KAIS_DOM@ "
            End If
            If Hensu.param.pKojChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KJU.KOJ		    @KOJ_DOM@ "
            End If
            If Hensu.param.pKojUwChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KJU.CODE		@KOJ_UW_DOM@ "
            End If
            If Hensu.param.pTorChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KJU.SEIK		@TOR_DOM@ "
            End If
            If Hensu.param.pEigyoTantChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KJU.EIGYO_TANT  @EIGYO_TANT_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		KJU.BMN_UW  IN "
            xSqlTxt = xSqlTxt & vbCrLf & "                      (SELECT BMN_UW FROM W_BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "                      WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "                              @SYSUSERNO@     = USER_NO "
            xSqlTxt = xSqlTxt & vbCrLf & "                      AND     @SESSION_ID@    = SESSION_ID "
            xSqlTxt = xSqlTxt & vbCrLf & "                      AND     @PROGRAM_CODE@  = PROGRAM_CODE) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KOJ.KAIS       = KAI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KJU.BMN_UW     = BMN.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KJU.HACH       = TO2.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KJU.SEIK = TOR.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KJU.YOBI_CODE2 = MEI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KJU.EIGYO_TANT = TAE.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KJU.KOJ_TANT = TAK.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KJU.NYU_KANRI_KBN =0) "
            xSqlTxt = xSqlTxt & vbCrLf & "		)	KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",		(SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "				SEK.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SEK.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SEK.KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(NVL(KIN,0)) SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(NVL(U_ZEI,0)) SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(FUN_IIFDATE(SEIK_DATE,'>=',@START_DDATE_FROM_SIME@,FUN_IIFDATE(SEIK_DATE,'<=',@END_DDATE_TO_SIME@,NVL(KIN,0),0),0)) T_SEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1),NVL(KIN,0),0))) N1MSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1),NVL(U_ZEI,0),0))) N1MSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',@START_DDATE_FROM_1@,NVL(KIN,0),0)))				NRSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(KIN,0),0))) NR1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(KIN,0),0))) NR2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(KIN,0),0))) NR3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(KIN,0),0))) NR4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(KIN,0),0))) NR5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@,NVL(KIN,0),0))) NSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(KIN,0),0))) N1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(KIN,0),0))) N2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(KIN,0),0))) N3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(KIN,0),0))) N4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(KIN,0),0))) N5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@,NVL(U_ZEI,0),0))) NSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(U_ZEI,0),0))) N1SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(U_ZEI,0),0))) N2SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(U_ZEI,0),0))) N3SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(U_ZEI,0),0))) N4SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(U_ZEI,0),0))) N5SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		 FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "				D_SEIK		SEK "
            xSqlTxt = xSqlTxt & vbCrLf & "		GROUP BY  "
            xSqlTxt = xSqlTxt & vbCrLf & "				SEK.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SEK.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SEK.KOJ_UW) SUB "
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "		(KOJ.KAIS	= SUB.KAIS(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(KOJ.KOJ	= SUB.KOJ(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(KOJ.KOJ_UW	= SUB.KOJ_UW(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "UNION "
            ''販売工事
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "		KOJ.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		KOJ.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.T_SEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1MSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1MSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NRSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NR5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.NSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N1SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N2SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N3SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N4SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUB.N5SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & ",     1 HANBAI_SW "
            xSqlTxt = xSqlTxt & vbCrLf & "FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "		(SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "				KOJ.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KEI.KEIY SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.RYAKU SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KANA  SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.NAME  SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.NAME2 SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		TOR.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		KOJ.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "				F_KEIYAKU		KEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		V_HACH			TOR "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		(SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "						KOJ.KAIS KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KAI.RYAKU   KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KJU.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		BMN.RYAKU   BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KJU.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KJU.CODE KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KJU.RYAKU KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KJU.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		TOR.RYAKU   HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KJU.YOBI_CODE2	  KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		MEI.RYAKU		 KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		TAE.NAME		 EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		TAK.NAME		 KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KJU.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KJU.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KJU.KEIY_KIN + KJU.KEIY_KIN_HEN KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		KJU.ZEI_KIN  + KJU.ZEI_KIN_HEN	ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "				FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "						M_KOJ		KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		M_KOJ_UW	KJU "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		M_KAIS      KAI "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		M_BMN_UW    BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		M_TOR       TOR "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		M_TANT TAE "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		M_TANT TAK "
            xSqlTxt = xSqlTxt & vbCrLf & "				,		(SELECT CODE, RYAKU FROM M_MEI WHERE MKBN = 3207600) MEI "
            xSqlTxt = xSqlTxt & vbCrLf & "				WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "						(KJU.KOJ = KJU.BMN_UW) "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		(KJU.KOJ = KOJ.CODE) "
            If Hensu.param.pKaisChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		KOJ.KAIS		@KAIS_DOM@ "
            End If
            If Hensu.param.pKojChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		KJU.KOJ		    @KOJ_DOM@ "
            End If
            If Hensu.param.pKojUwChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		KJU.CODE		@KOJ_UW_DOM@ "
            End If
            If Hensu.param.pEigyoTantChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		KJU.EIGYO_TANT  @EIGYO_TANT_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		KJU.BMN_UW  IN "
            xSqlTxt = xSqlTxt & vbCrLf & "              		        (SELECT BMN_UW FROM W_BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "              		        WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "              		                @SYSUSERNO@     = USER_NO "
            xSqlTxt = xSqlTxt & vbCrLf & "              		        AND     @SESSION_ID@    = SESSION_ID "
            xSqlTxt = xSqlTxt & vbCrLf & "               		        AND     @PROGRAM_CODE@  = PROGRAM_CODE) "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		(KOJ.KAIS       =   KAI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		(KJU.BMN_UW     =   BMN.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		(KJU.HACH       =   TOR.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		(KJU.YOBI_CODE2 = MEI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		(KJU.EIGYO_TANT = TAE.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		(KJU.KOJ_TANT = TAK.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		(KJU.NYU_KANRI_KBN =0) "
            xSqlTxt = xSqlTxt & vbCrLf & "				)		KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "		WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "				1		=	1 "
            If Hensu.param.pTorChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KEI.KEIY		@TOR_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KEI.KAIS = KOJ.KAIS) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KEI.BMN_UW = KOJ.KOJ) "
            xSqlTxt = xSqlTxt & vbCrLf & "		AND		(KEI.KEIY = TOR.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "		)	KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",		(SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "				SEK.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SEK.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SEK.KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SEK.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(NVL(KIN,0)) SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(NVL(U_ZEI,0)) SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(FUN_IIFDATE(SEIK_DATE,'>=',@START_DDATE_FROM_SIME@,FUN_IIFDATE(SEIK_DATE,'<=',@END_DDATE_TO_SIME@,NVL(KIN,0),0),0)) T_SEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1),NVL(KIN,0),0))) N1MSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1),NVL(U_ZEI,0),0))) N1MSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',@START_DDATE_FROM_1@,NVL(KIN,0),0)))				NRSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(KIN,0),0))) NR1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(KIN,0),0))) NR2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(KIN,0),0))) NR3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(KIN,0),0))) NR4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(KIN,0),0))) NR5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@,NVL(KIN,0),0))) NSEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(KIN,0),0))) N1SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(KIN,0),0))) N2SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(KIN,0),0))) N3SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(KIN,0),0))) N4SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(KIN,0),0))) N5SEIK_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@,NVL(U_ZEI,0),0))) NSEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(U_ZEI,0),0))) N1SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(U_ZEI,0),0))) N2SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(U_ZEI,0),0))) N3SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(U_ZEI,0),0))) N4SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SUM(DECODE(SEIK_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(U_ZEI,0),0))) N5SEIK_ZEI "
            xSqlTxt = xSqlTxt & vbCrLf & "		FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "				D_SEIK		SEK "
            xSqlTxt = xSqlTxt & vbCrLf & "		GROUP BY  "
            xSqlTxt = xSqlTxt & vbCrLf & "				SEK.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SEK.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SEK.KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "		,		SEK.SEIK ) SUB "
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "		(KOJ.KAIS	= SUB.KAIS(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(KOJ.KOJ	= SUB.KOJ(+))  "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(KOJ.KOJ_UW	= SUB.KOJ_UW(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(KOJ.SEIK	= SUB.SEIK(+)) "
        End If
        fSqlTxt_1 = xSqlTxt
    End Function

    ''' <summary>
    ''' fSqlTxt_2 - 元SQLを持ってくる
    ''' </summary>
    ''' <returns>SQL文</returns>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Function fSqlTxt_2() As String
        Dim xSqlTxt As String

        xSqlTxt = ""
        If Hensu.param.pKojShukeOpt = 1 Then
            ''通常工事
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "       K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N1MSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.NSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N1SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N2SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N3SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N4SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N5SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.TOU_NYUK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.TOU_SEIK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      0 HANBAI_SW "
            xSqlTxt = xSqlTxt & vbCrLf & "FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "    (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "            K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KAI.RYAKU         KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      BMN.RYAKU         BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.CODE 			KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.RYAKU 			KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.SEIK 			SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.RYAKU 			SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KANA 			SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME 			SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME2 			SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TO2.RYAKU         HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.YOBI_CODE2   	KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      MEI.RYAKU      	KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TAE.NAME       	EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TAK.NAME       	KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.KEIY_KIN + K.KEIY_KIN_HEN 	KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.ZEI_KIN  + K.ZEI_KIN_HEN  	ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            M_KOJ 		K "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_KAIS        KAI "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_BMN_UW      BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_TOR         TO2 "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_TANT 		TAE "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_TANT 		TAK "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      V_HACH 		T "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      ( SELECT CODE, RYAKU FROM M_MEI WHERE MKBN = 3207600 ) 	MEI "
            xSqlTxt = xSqlTxt & vbCrLf & "     WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "            (K.CODE <> K.BMN_UW) "
            If Hensu.param.pKaisChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		K.KAIS		    @KAIS_DOM@ "
            End If
            If Hensu.param.pKojChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		K.CODE		    @KOJ_DOM@ "
            End If
            If Hensu.param.pTorChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		K.SEIK		    @TOR_DOM@ "
            End If
            If Hensu.param.pEigyoTantChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		K.EIGYO_TANT    @EIGYO_TANT_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "     AND	  (K.BMN_UW  IN "
            xSqlTxt = xSqlTxt & vbCrLf & "                      (SELECT BMN_UW FROM W_BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "                      WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "                              @SYSUSERNO@     = USER_NO "
            xSqlTxt = xSqlTxt & vbCrLf & "                      AND     @SESSION_ID@    = SESSION_ID "
            xSqlTxt = xSqlTxt & vbCrLf & "                      AND     @PROGRAM_CODE@  = PROGRAM_CODE)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.SEIK 			= T.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.KAIS 			= KAI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.BMN_UW			= BMN.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.HACH			= TO2.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.YOBI_CODE2 	= MEI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.EIGYO_TANT 	= TAE.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.KOJ_TANT 		= TAK.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.NYU_KANRI_KBN 	= 0)) K "
            xSqlTxt = xSqlTxt & vbCrLf & ",   (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 	N1MSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@,NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 					NSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 		N1SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 		N2SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 		N3SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 		N4SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 		N5SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(NYU_YOTEI_DATE,'>=',@START_DDATE_FROM_SIME@,FUN_IIFDATE(NYU_YOTEI_DATE,'<=',@END_DDATE_TO_SIME@,NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0),0)) 				TOU_NYUK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(SEIK_YOTEI_DATE,'>=',@START_DDATE_FROM_SIME@,FUN_IIFDATE(SEIK_YOTEI_DATE,'<=',@END_DDATE_TO_SIME@,NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0),0)) 				TOU_SEIK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            D_SEIK_NYU "
            xSqlTxt = xSqlTxt & vbCrLf & "     GROUP BY "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ) N "
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "    	(K.KAIS = N.KAIS(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(K.KOJ  = N.KOJ(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "UNION "
            ''販売工事
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "       K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N1MSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.NSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N1SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N2SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N3SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N4SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N5SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.TOU_NYUK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.TOU_SEIK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      1 HANBAI_SW "
            xSqlTxt = xSqlTxt & vbCrLf & "FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "    (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "            KJ.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KE.KEIY 		    SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.RYAKU 		    SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KANA 		    SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME 		    SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME2 		    SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "    FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            F_KEIYAKU 	    KE "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      V_HACH 		    T "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "                    K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KAI.RYAKU         KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      BMN.RYAKU         BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.CODE KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.RYAKU      		KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      TO2.RYAKU         HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.YOBI_CODE2 		KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      MEI.RYAKU    		KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      TAE.NAME     		EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      TAK.NAME     		KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.KEIY_KIN + K.KEIY_KIN_HEN 	KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.ZEI_KIN  + K.ZEI_KIN_HEN  	ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "             FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "                    M_KOJ 		K "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_KAIS 		KAI "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_BMN_UW 		BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_TOR  		TO2 "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_TANT 		TAE "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_TANT 		TAK "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      (SELECT CODE, RYAKU FROM M_MEI WHERE MKBN = 3207600) MEI "
            xSqlTxt = xSqlTxt & vbCrLf & "             WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "                    (K.CODE = K.BMN_UW) "
            If Hensu.param.pKaisChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		K.KAIS          @KAIS_DOM@ "
            End If
            If Hensu.param.pKojChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		K.CODE          @KOJ_DOM@ "
            End If
            If Hensu.param.pEigyoTantChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		K.EIGYO_TANT    @EIGYO_TANT_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "		       AND	  (K.BMN_UW  IN "
            xSqlTxt = xSqlTxt & vbCrLf & "              		            (SELECT BMN_UW FROM W_BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "              		            WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "              		                    @SYSUSERNO@     = USER_NO "
            xSqlTxt = xSqlTxt & vbCrLf & "              		            AND     @SESSION_ID@    = SESSION_ID "
            xSqlTxt = xSqlTxt & vbCrLf & "               		            AND     @PROGRAM_CODE@  = PROGRAM_CODE)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.KAIS 	        = KAI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.BMN_UW	        = BMN.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.HACH 	        = TO2.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.YOBI_CODE2 	= MEI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.EIGYO_TANT 	= TAE.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.KOJ_TANT 		= TAK.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.NYU_KANRI_KBN 	= 0)) KJ "
            xSqlTxt = xSqlTxt & vbCrLf & "    WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "			   1            =   1 "
            If Hensu.param.pTorChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KE.KEIY      @TOR_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KE.KAIS 		= KJ.KAIS) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KE.BMN_UW 	= KJ.KOJ) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KE.KEIY 		= T.CODE(+))) K "
            xSqlTxt = xSqlTxt & vbCrLf & ",  (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 	N1MSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@,NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 					NSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 		N1SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 		N2SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 		N3SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 		N4SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 		N5SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(NYU_YOTEI_DATE,'>=',@START_DDATE_FROM_SIME@,FUN_IIFDATE(NYU_YOTEI_DATE,'<=',@END_DDATE_TO_SIME@,NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0),0)) 			    TOU_NYUK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(SEIK_YOTEI_DATE,'>=',@START_DDATE_FROM_SIME@,FUN_IIFDATE(SEIK_YOTEI_DATE,'<=',@END_DDATE_TO_SIME@,NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0),0)) 				TOU_SEIK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "    FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            D_SEIK_NYU "
            xSqlTxt = xSqlTxt & vbCrLf & "    GROUP BY "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SEIK) N "
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "       (K.KAIS = N.KAIS(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND    (K.KOJ  = N.KOJ(+))  "
            xSqlTxt = xSqlTxt & vbCrLf & "AND    (K.SEIK = N.SEIK(+)) "

        Else
            ''通常工事
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "       K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N1MSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.NSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N1SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N2SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N3SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N4SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N5SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.TOU_NYUK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.TOU_SEIK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      0 HANBAI_SW "
            xSqlTxt = xSqlTxt & vbCrLf & "FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "    (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "            K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KAI.RYAKU                         KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      BMN.RYAKU                         BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.CODE 			                KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.RYAKU 			                KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.SEIK 			                SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.RYAKU 			                SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KANA 			                SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME 			                SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME2 			                SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TO2.RYAKU                         HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.YOBI_CODE2   	                KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      MEI.RYAKU      	                KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TAE.NAME       	                EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TAK.NAME       	                KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.KEIY_KIN + KU.KEIY_KIN_HEN 	KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.ZEI_KIN  + KU.ZEI_KIN_HEN  	ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            M_KOJ 		K "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_KAIS 		KAI "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_BMN_UW 		BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_TOR 		TO2 "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_KOJ_UW 		KU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_TANT 		TAE "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_TANT 		TAK "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      V_HACH 		T "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      (SELECT CODE, RYAKU FROM M_MEI WHERE MKBN = 3207600) MEI "
            xSqlTxt = xSqlTxt & vbCrLf & "     WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "            (KU.KOJ <> KU.BMN_UW) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.KOJ 	= K.CODE) "
            If Hensu.param.pKaisChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		K.KAIS		    @KAIS_DOM@ "
            End If
            If Hensu.param.pKojChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KU.KOJ		    @KOJ_DOM@ "
            End If
            If Hensu.param.pKojUwChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KU.CODE		    @KOJ_UW_DOM@ "
            End If
            If Hensu.param.pTorChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KU.SEIK		    @TOR_DOM@ "
            End If
            If Hensu.param.pEigyoTantChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KU.EIGYO_TANT   @EIGYO_TANT_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "     AND	  (KU.BMN_UW  IN "
            xSqlTxt = xSqlTxt & vbCrLf & "                      (SELECT BMN_UW FROM W_BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "                      WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "                              @SYSUSERNO@     = USER_NO "
            xSqlTxt = xSqlTxt & vbCrLf & "                      AND     @SESSION_ID@    = SESSION_ID "
            xSqlTxt = xSqlTxt & vbCrLf & "                      AND     @PROGRAM_CODE@  = PROGRAM_CODE)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.KAIS 			= KAI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.BMN_UW		= BMN.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.HACH 			= TO2.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.SEIK 			= T.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.YOBI_CODE2 	= MEI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.EIGYO_TANT 	= TAE.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.KOJ_TANT 		= TAK.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.NYU_KANRI_KBN = 0)) K "
            xSqlTxt = xSqlTxt & vbCrLf & ",   (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 	N1MSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@,NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 					NSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 	    N1SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 	    N2SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 	    N3SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 	    N4SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 	    N5SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(NYU_YOTEI_DATE,'>=',@START_DDATE_FROM_SIME@,FUN_IIFDATE(NYU_YOTEI_DATE,'<=',@END_DDATE_TO_SIME@,NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0),0)) 				TOU_NYUK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(SEIK_YOTEI_DATE,'>=',@START_DDATE_FROM_SIME@,FUN_IIFDATE(SEIK_YOTEI_DATE,'<=',@END_DDATE_TO_SIME@,NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0),0)) 				TOU_SEIK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            D_SEIK_NYU "
            xSqlTxt = xSqlTxt & vbCrLf & "     GROUP BY "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ_UW) N "
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "    (K.KAIS 	= N.KAIS(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND (K.KOJ  	= N.KOJ(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND (K.KOJ_UW = N.KOJ_UW(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "UNION "
            ''販売工事
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "       K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N1MSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.NSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N1SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N2SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N3SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N4SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.N5SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.TOU_NYUK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      N.TOU_SEIK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      1 HANBAI_SW "
            xSqlTxt = xSqlTxt & vbCrLf & "FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "    (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "            KJ.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KE.KEIY 		        SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.RYAKU 		        SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KANA 		        SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME 		        SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME2 		        SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "    FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            F_KEIYAKU 	KE "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      V_HACH 		T "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "                    K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KAI.RYAKU                         KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      BMN.RYAKU                         BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.CODE 			                KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.RYAKU      	                KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      TO2.RYAKU                         HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.YOBI_CODE2 	                KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      MEI.RYAKU    		                KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      TAE.NAME     		                EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      TAK.NAME     		                KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.KEIY_KIN + KU.KEIY_KIN_HEN 	KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.ZEI_KIN  + KU.ZEI_KIN_HEN  	ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "             FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "                    M_KOJ 		K "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_KAIS        KAI "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_BMN_UW      BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_TOR         TO2 "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_KOJ_UW 		KU "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_TANT 		TAE "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_TANT 		TAK "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      (SELECT CODE, RYAKU FROM M_MEI WHERE MKBN = 3207600) MEI "
            xSqlTxt = xSqlTxt & vbCrLf & "             WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "                    (KU.KOJ = KU.BMN_UW) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (KU.KOJ = K.CODE) "
            If Hensu.param.pKaisChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		K.KAIS		    @KAIS_DOM@ "
            End If
            If Hensu.param.pKojChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		KU.KOJ		    @KOJ_DOM@ "
            End If
            If Hensu.param.pKojUwChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		KU.CODE		    @KOJ_UW_DOM@ "
            End If
            If Hensu.param.pEigyoTantChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		KU.EIGYO_TANT   @EIGYO_TANT_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "	           AND	  (KU.BMN_UW  IN "
            xSqlTxt = xSqlTxt & vbCrLf & "              		            (SELECT BMN_UW FROM W_BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "              		            WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "              		                    @SYSUSERNO@     = USER_NO "
            xSqlTxt = xSqlTxt & vbCrLf & "              		            AND     @SESSION_ID@    = SESSION_ID "
            xSqlTxt = xSqlTxt & vbCrLf & "               		            AND     @PROGRAM_CODE@  = PROGRAM_CODE)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.KAIS        	= KAI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (KU.BMN_UW 	    = BMN.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (KU.HACH       	= TO2.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (KU.YOBI_CODE2 	= MEI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (KU.EIGYO_TANT 	= TAE.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (KU.KOJ_TANT 		= TAK.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (KU.NYU_KANRI_KBN = 0)) KJ "
            xSqlTxt = xSqlTxt & vbCrLf & "    WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "			   1		    =	1 "
            If Hensu.param.pTorChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "      AND		KE.KEIY		@TOR_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "    AND     (KE.KAIS 		= KJ.KAIS) "
            xSqlTxt = xSqlTxt & vbCrLf & "    AND     (KE.BMN_UW 	= KJ.KOJ) "
            xSqlTxt = xSqlTxt & vbCrLf & "    AND     (KE.KEIY 		= T.CODE(+))) K "
            xSqlTxt = xSqlTxt & vbCrLf & ",  (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 	N1MSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@,NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 					NSEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,1),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 	    N1SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,2),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 	    N2SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,3),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 	    N3SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,4),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 	    N4SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(SEIK_YOTEI_DATE,NULL,0,FUN_IIFDATE(FUN_SIME(SEIK_YOTEI_DATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,5),NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0))) 	    N5SEIK_Y_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(NYU_YOTEI_DATE,'>=',@START_DDATE_FROM_SIME@,FUN_IIFDATE(NYU_YOTEI_DATE,'<=',@END_DDATE_TO_SIME@,NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0),0)) 				TOU_NYUK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(SEIK_YOTEI_DATE,'>=',@START_DDATE_FROM_SIME@,FUN_IIFDATE(SEIK_YOTEI_DATE,'<=',@END_DDATE_TO_SIME@,NVL(KIN,0)+NVL(TEG,0)+NVL(SOUSAI,0),0),0)) 				TOU_SEIK_YOTEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "    FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            D_SEIK_NYU "
            xSqlTxt = xSqlTxt & vbCrLf & "    GROUP BY "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SEIK) N "
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "       (K.KAIS 	= N.KAIS(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND    (K.KOJ  	= N.KOJ(+))  "
            xSqlTxt = xSqlTxt & vbCrLf & "AND    (K.KOJ_UW 	= N.KOJ_UW(+))  "
            xSqlTxt = xSqlTxt & vbCrLf & "AND    (K.SEIK 	= N.SEIK(+)) "
        End If

        fSqlTxt_2 = xSqlTxt
    End Function

    ''' <summary>
    ''' fSqlTxt_3 - 元SQLを持ってくる
    ''' </summary>
    ''' <returns>SQL文</returns>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Function fSqlTxt_3() As String
        Dim xSqlTxt As String

        xSqlTxt = ""
        If Hensu.param.pKojShukeOpt = 1 Then
            ''通常工事
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "       K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.ZEN_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.T_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N1MNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NRNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      0  HANBAI_SW "
            xSqlTxt = xSqlTxt & vbCrLf & "FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "    (SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "            K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KAI.RYAKU                     KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      BMN.RYAKU                     BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.CODE                        KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.RYAKU                       KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.RYAKU                       SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KANA                        SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME                        SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME2                       SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TO2.RYAKU                     HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.YOBI_CODE2                  KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      MEI.RYAKU                     KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TAE.NAME                      EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TAK.NAME                      KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.KEIY_KIN + K.KEIY_KIN_HEN   KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      K.ZEI_KIN  + K.ZEI_KIN_HEN    ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            M_KOJ     K "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      V_HACH    T "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_KAIS    KAI "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_BMN_UW  BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_TOR    TO2 "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_TANT    TAE "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_TANT    TAK "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      (SELECT CODE, RYAKU FROM M_MEI WHERE MKBN = 3207600) MEI "
            xSqlTxt = xSqlTxt & vbCrLf & "     WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "            (K.CODE   <> K.BMN_UW) "
            If Hensu.param.pKaisChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		K.KAIS		    @KAIS_DOM@ "
            End If
            If Hensu.param.pKojChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		K.CODE		    @KOJ_DOM@ "
            End If
            If Hensu.param.pTorChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		K.SEIK		    @TOR_DOM@ "
            End If
            If Hensu.param.pEigyoTantChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		K.EIGYO_TANT    @EIGYO_TANT_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "     AND	  (K.BMN_UW  IN "
            xSqlTxt = xSqlTxt & vbCrLf & "                      (SELECT BMN_UW FROM W_BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "                      WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "                              @SYSUSERNO@     = USER_NO "
            xSqlTxt = xSqlTxt & vbCrLf & "                      AND     @SESSION_ID@    = SESSION_ID "
            xSqlTxt = xSqlTxt & vbCrLf & "                      AND     @PROGRAM_CODE@  = PROGRAM_CODE)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.KAIS           = KAI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.BMN_UW         = BMN.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.HACH           = TO2.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.SEIK           = T.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.YOBI_CODE2     = MEI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.EIGYO_TANT     = TAE.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.KOJ_TANT       = TAK.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.NYU_KANRI_KBN  =　0)) K "
            xSqlTxt = xSqlTxt & vbCrLf & ",   (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0))                                                         NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(DDATE,'<',@START_DDATE_FROM_SIME@, DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0))       ZEN_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(DDATE,'>=',@START_DDATE_FROM_SIME@, "
            xSqlTxt = xSqlTxt & vbCrLf & "            FUN_IIFDATE(DDATE,'<=',@END_DDATE_TO_SIME@, DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0),0))           T_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N1MNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',@START_DDATE_FROM_1@, "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NRNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+1), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+2), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+3), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+4), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+5), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@, "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+1), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+2), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+3), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+4), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+5), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            D_SHIWAKE_UW_NYU "
            xSqlTxt = xSqlTxt & vbCrLf & "     WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "            (TORIHIKI_KBN = 0) "
            xSqlTxt = xSqlTxt & vbCrLf & "     GROUP BY "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ)  UW "
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "       (K.KAIS = UW.KAIS(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND    (K.KOJ  = UW.KOJ(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "UNION "
            ''販売工事
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "       K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.ZEN_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.T_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N1MNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NRNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      1  HANBAI_SW "
            xSqlTxt = xSqlTxt & vbCrLf & "FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "    (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "            KJ.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KE.KEIY               SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.RYAKU               SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KANA                SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME                SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME2               SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "    FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            F_KEIYAKU     KE "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      V_HACH        T "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "                    K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KAI.RYAKU                     KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      BMN.RYAKU                     BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.CODE KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.RYAKU                       KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      TO2.RYAKU                     HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.YOBI_CODE2                  KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      MEI.RYAKU                     KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      TAE.NAME                      EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      TAK.NAME                      KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.KEIY_KIN + K.KEIY_KIN_HEN   KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      K.ZEI_KIN  + K.ZEI_KIN_HEN    ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "             FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "                    M_KOJ K "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_KAIS    KAI "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_BMN_UW  BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_TOR     TO2 "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_TANT TAE "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_TANT TAK "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      (SELECT CODE, RYAKU FROM M_MEI WHERE MKBN = 3207600) MEI "
            xSqlTxt = xSqlTxt & vbCrLf & "             WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "                    (K.CODE   = K.BMN_UW) "
            If Hensu.param.pKaisChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		K.KAIS          @KAIS_DOM@ "
            End If
            If Hensu.param.pKojChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		K.CODE          @KOJ_DOM@ "
            End If
            If Hensu.param.pEigyoTantChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		K.EIGYO_TANT    @EIGYO_TANT_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "		       AND	   (K.BMN_UW  IN "
            xSqlTxt = xSqlTxt & vbCrLf & "              		            (SELECT BMN_UW FROM W_BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "              		            WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "              		                    @SYSUSERNO@     = USER_NO "
            xSqlTxt = xSqlTxt & vbCrLf & "              		            AND     @SESSION_ID@    = SESSION_ID "
            xSqlTxt = xSqlTxt & vbCrLf & "               		            AND     @PROGRAM_CODE@  = PROGRAM_CODE)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.KAN_FURI       >= @START_DDATE_FROM_SIME@) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.KAIS           = KAI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.BMN_UW         = BMN.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.HACH           = TO2.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.YOBI_CODE2     = MEI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.EIGYO_TANT     = TAE.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.KOJ_TANT       = TAK.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.NYU_KANRI_KBN  =　0)) KJ "
            xSqlTxt = xSqlTxt & vbCrLf & "    WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "			   1            =   1 "
            If Hensu.param.pTorChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KE.KEIY      @TOR_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "    AND     (KE.KAIS      = KJ.KAIS) "
            xSqlTxt = xSqlTxt & vbCrLf & "    AND     (KE.BMN_UW    = KJ.KOJ) "
            xSqlTxt = xSqlTxt & vbCrLf & "    AND     (KE.KEIY      = T.CODE(+))) K "
            xSqlTxt = xSqlTxt & vbCrLf & ",   (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TOR "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0))                                                         NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(DDATE,'<',@START_DDATE_FROM_SIME@, DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0))       ZEN_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(DDATE,'>=',@START_DDATE_FROM_SIME@, "
            xSqlTxt = xSqlTxt & vbCrLf & "            FUN_IIFDATE(DDATE,'<=',@END_DDATE_TO_SIME@, DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0),0))           T_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N1MNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',@START_DDATE_FROM_1@, "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NRNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+1), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+2), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+3), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+4), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+5), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@, "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+1), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+2), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+3), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+4), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+5), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            D_SHIWAKE_UW_NYU "
            xSqlTxt = xSqlTxt & vbCrLf & "     WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "            (TORIHIKI_KBN = 0) "
            xSqlTxt = xSqlTxt & vbCrLf & "     GROUP BY "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TOR) UW "
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "       (K.KAIS = UW.KAIS(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND    (K.KOJ  = UW.KOJ(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND    (K.SEIK = UW.TOR(+)) "

        Else
            ''通常工事
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "       K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.ZEN_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.T_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N1MNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NRNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      0  HANBAI_SW "
            xSqlTxt = xSqlTxt & vbCrLf & "FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "    (SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "            K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KAI.RYAKU     KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      BMN.RYAKU     BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.CODE                           KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.RYAKU                          KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.RYAKU                           SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KANA                            SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME                            SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME2                           SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TO2.RYAKU                         HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.YOBI_CODE2                     KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      MEI.RYAKU                         KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TAE.NAME                          EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TAK.NAME                          KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.KEIY_KIN + KU.KEIY_KIN_HEN     KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KU.ZEI_KIN  + KU.ZEI_KIN_HEN      ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            M_KOJ         K "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_KAIS        KAI "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_BMN_UW      BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_TOR         TO2 "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_KOJ_UW      KU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      V_HACH        T "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_TANT        TAE "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      M_TANT        TAK "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      (SELECT CODE, RYAKU FROM M_MEI WHERE MKBN = 3207600) MEI "
            xSqlTxt = xSqlTxt & vbCrLf & "     WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "            (KU.KOJ   <> KU.BMN_UW) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.KOJ   = K.CODE) "
            If Hensu.param.pKaisChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		K.KAIS		    @KAIS_DOM@ "
            End If
            If Hensu.param.pKojChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KU.KOJ		    @KOJ_DOM@ "
            End If
            If Hensu.param.pKojUwChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KU.CODE		    @KOJ_UW_DOM@ "
            End If
            If Hensu.param.pTorChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KU.SEIK		    @TOR_DOM@ "
            End If
            If Hensu.param.pEigyoTantChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KU.EIGYO_TANT   @EIGYO_TANT_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "     AND	  (KU.BMN_UW  IN "
            xSqlTxt = xSqlTxt & vbCrLf & "                      (SELECT BMN_UW FROM W_BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "                      WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "                              @SYSUSERNO@     = USER_NO "
            xSqlTxt = xSqlTxt & vbCrLf & "                      AND     @SESSION_ID@    = SESSION_ID "
            xSqlTxt = xSqlTxt & vbCrLf & "                      AND     @PROGRAM_CODE@  = PROGRAM_CODE)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.SEIK          = T.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (K.KAIS           = KAI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.BMN_UW        = BMN.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.HACH          = TO2.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.YOBI_CODE2    = MEI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.EIGYO_TANT    = TAE.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.KOJ_TANT      = TAK.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "     AND    (KU.NYU_KANRI_KBN = 0)) K "
            xSqlTxt = xSqlTxt & vbCrLf & ",   (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0))                                                         NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(DDATE,'<',@START_DDATE_FROM_SIME@, DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0))       ZEN_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(DDATE,'>=',@START_DDATE_FROM_SIME@, "
            xSqlTxt = xSqlTxt & vbCrLf & "            FUN_IIFDATE(DDATE,'<=',@END_DDATE_TO_SIME@, DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0),0))           T_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N1MNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',@START_DDATE_FROM_1@, "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NRNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+1), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+2), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+3), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+4), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+5), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@, "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+1), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+2), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+3), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+4), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+5), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            D_SHIWAKE_UW_NYU "
            xSqlTxt = xSqlTxt & vbCrLf & "     WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "            (TORIHIKI_KBN = 0) "
            xSqlTxt = xSqlTxt & vbCrLf & "     GROUP BY "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ_UW)   UW "
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "       (K.KAIS        = UW.KAIS(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND    (K.KOJ         = UW.KOJ(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND    (K.KOJ_UW      = UW.KOJ_UW(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "UNION "
            ''販売工事
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "       K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      K.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.ZEN_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.T_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N1MNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NRNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NR5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.NNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      UW.N5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",      1  HANBAI_SW "
            xSqlTxt = xSqlTxt & vbCrLf & "FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "    (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "            KJ.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KE.KEIY               SEIK "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.RYAKU               SEIK_RYAKU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KANA                SEIK_KANA "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME                SEIK_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.NAME2               SEIK_NAME2 "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KBN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.SIME_HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_KIN_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.KAISYU_TEG_SAIT "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      T.HORYU_RITU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KJ.ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "    FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            F_KEIYAKU KE "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      V_HACH T "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "                    K.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KAI.RYAKU     KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      BMN.RYAKU     BMN_UW_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.CODE                           KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.RYAKU                          KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.HACH "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      TO2.RYAKU     HACH_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.YOBI_CODE2                     KOUHOU "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      MEI.RYAKU                         KOUHOU_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      TAE.NAME                          EIGYO_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      TAK.NAME                          KOJ_TANT_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.KEIY_KIN + KU.KEIY_KIN_HEN     KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      KU.ZEI_KIN  + KU.ZEI_KIN_HEN      ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "             FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "                    M_KOJ         K "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_KOJ_UW      KU "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_KAIS        KAI "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_BMN_UW      BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_TOR         TO2 "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_TANT        TAE "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      M_TANT        TAK "
            xSqlTxt = xSqlTxt & vbCrLf & "             ,      (SELECT CODE, RYAKU FROM M_MEI WHERE MKBN = 3207600) MEI "
            xSqlTxt = xSqlTxt & vbCrLf & "             WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "                    (KU.KOJ       = KU.BMN_UW) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (KU.KOJ       = K.CODE) "
            If Hensu.param.pKaisChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		K.KAIS		    @KAIS_DOM@ "
            End If
            If Hensu.param.pKojChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		KU.KOJ		    @KOJ_DOM@ "
            End If
            If Hensu.param.pKojUwChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		KU.CODE		    @KOJ_UW_DOM@ "
            End If
            If Hensu.param.pEigyoTantChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "				AND		KU.EIGYO_TANT   @EIGYO_TANT_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "	      AND	 (KU.BMN_UW  IN "
            xSqlTxt = xSqlTxt & vbCrLf & "              		        (SELECT BMN_UW FROM W_BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "              		        WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "              		                @SYSUSERNO@     = USER_NO "
            xSqlTxt = xSqlTxt & vbCrLf & "              		        AND     @SESSION_ID@    = SESSION_ID "
            xSqlTxt = xSqlTxt & vbCrLf & "               		        AND     @PROGRAM_CODE@  = PROGRAM_CODE)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (KU.KAN_FURI      >= @START_DDATE_FROM_SIME@) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (K.KAIS           = KAI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (KU.BMN_UW        = BMN.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (KU.HACH          = TO2.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (KU.YOBI_CODE2    = MEI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (KU.EIGYO_TANT    = TAE.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (KU.KOJ_TANT      = TAK.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "             AND    (KU.NYU_KANRI_KBN = 0)) KJ "
            xSqlTxt = xSqlTxt & vbCrLf & "    WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "			   1		    =	1 "
            If Hensu.param.pTorChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "		AND		KE.KEIY		@TOR_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "    AND     (KE.KAIS      = KJ.KAIS) "
            xSqlTxt = xSqlTxt & vbCrLf & "    AND     (KE.BMN_UW    = KJ.KOJ) "
            xSqlTxt = xSqlTxt & vbCrLf & "    AND     (KE.KEIY      = T.CODE(+))) K "
            xSqlTxt = xSqlTxt & vbCrLf & ",   (SELECT  "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TOR "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0))                                                         NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(DDATE,'<',@START_DDATE_FROM_SIME@, DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0))       ZEN_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(FUN_IIFDATE(DDATE,'>=',@START_DDATE_FROM_SIME@, "
            xSqlTxt = xSqlTxt & vbCrLf & "            FUN_IIFDATE(DDATE,'<=',@END_DDATE_TO_SIME@, DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0),0))           T_NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,-1), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N1MNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',@START_DDATE_FROM_1@, "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NRNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+1), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+2), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+3), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+4), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'<=',ADD_MONTHS(@START_DDATE_FROM_1@,+5), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NR5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',@START_DDATE_FROM_1@, "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  NNYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+1), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N1NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+2), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N2NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+3), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N3NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+4), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N4NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      SUM(DECODE(DDATE,NULL,0,FUN_IIFDATE(FUN_SIME(DDATE,@SIME_DATE@),'=',ADD_MONTHS(@START_DDATE_FROM_1@,+5), "
            xSqlTxt = xSqlTxt & vbCrLf & "                                   DECODE(TS_KBN,2,1,-1) * NVL(KIN + ZEI,0),0)))                                  N5NYU_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "     FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "            D_SHIWAKE_UW_NYU "
            xSqlTxt = xSqlTxt & vbCrLf & "     WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "            (TORIHIKI_KBN = 0) "
            xSqlTxt = xSqlTxt & vbCrLf & "     GROUP BY "
            xSqlTxt = xSqlTxt & vbCrLf & "            KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & "     ,      TOR)  UW "
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "       (K.KAIS        = UW.KAIS(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND    (K.KOJ         = UW.KOJ(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND    (K.KOJ_UW      = UW.KOJ_UW(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND    (K.SEIK        = UW.TOR(+)) "
        End If

        fSqlTxt_3 = xSqlTxt
    End Function

    ''' <summary>
    ''' fSqlTxt_4
    ''' </summary>
    ''' <returns>SQL文</returns>
    ''' <remarks>元SQLを持ってくる</remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Function fSqlTxt_4() As String
        Dim xSqlTxt As String

        If Hensu.param.pKojShukeOpt = 1 Then
            xSqlTxt = ""
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "		SHI.KAIS KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(KAI.NAME) KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(KOJ.BMN_UW) BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(BMN.RYAKU) BMN_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SHI.KOJ KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(KOJ.RYAKU) KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(KOJ.SYUNKO) SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(KOJ.KAN_FURI) KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(KOJ.KEIY_KIN+KOJ.KEIY_KIN_HEN) KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(KOJ.ZEI_KIN+KOJ.ZEI_KIN_HEN) ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUM(DECODE(SHI.TS_KBN,1,-1,1) * NVL(SHI.KIN,0)) URI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "		M_KMK				KMK "
            xSqlTxt = xSqlTxt & vbCrLf & ",		D_SHIWAKE_UW_URI	SHI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		M_KOJ				KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",		M_KAIS				KAI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		M_BMN_UW			BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "		1		=	1 "
            If Hensu.param.pKaisChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "AND	SHI.KAIS			@KAIS_DOM@ "
            End If
            If Hensu.param.pKojChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "AND	SHI.KOJ 			@KOJ_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(SHI.KOJ_KMK_KBN = 3) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(SHI.TORIHIKI_KBN = 0) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	SHI.DDATE           <=  @END_DDATE_TO_SIME@ "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(SHI.KMK = KMK.CODE(+)) "
            If Hensu.param.pEigyoTantChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "AND	KOJ.EIGYO_TANT	    @EIGYO_TANT_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "AND	KOJ.KAN_FURI		>=  @START_DDATE_FROM_SIME@ "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	KOJ.BMN_UW	IN "
            xSqlTxt = xSqlTxt & vbCrLf & "				(SELECT BMN_UW FROM W_BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "				WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "						@SYSUSERNO@		= USER_NO "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		@SESSION_ID@	= SESSION_ID "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		@PROGRAM_CODE@	= PROGRAM_CODE) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(SHI.KAIS = KOJ.KAIS(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(SHI.KOJ = KOJ.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(SHI.KAIS = KAI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(KOJ.BMN_UW = BMN.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(KOJ.NYU_KANRI_KBN=0) "
            xSqlTxt = xSqlTxt & vbCrLf & "GROUP BY "
            xSqlTxt = xSqlTxt & vbCrLf & "		SHI.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SHI.KOJ "

        Else
            xSqlTxt = ""
            xSqlTxt = xSqlTxt & vbCrLf & "SELECT "
            xSqlTxt = xSqlTxt & vbCrLf & "		SHI.KAIS KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(KAI.NAME) KAIS_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(KJU.BMN_UW) BMN_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(BMN.RYAKU) BMN_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SHI.KOJ KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SHI.KOJ_UW KOJ_UW "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(KJU.RYAKU) KOJ_NAME "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(KJU.SYUNKO) SYUNKO "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(KJU.KAN_FURI) KAN_FURI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(KJU.KEIY_KIN+KJU.KEIY_KIN_HEN) KEIY_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		MAX(KJU.ZEI_KIN+KJU.ZEI_KIN_HEN) ZEI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SUM(DECODE(SHI.TS_KBN,1,-1,1) * NVL(SHI.KIN,0)) URI_KIN "
            xSqlTxt = xSqlTxt & vbCrLf & "FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "		M_KMK				KMK "
            xSqlTxt = xSqlTxt & vbCrLf & ",		D_SHIWAKE_UW_URI	SHI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		M_KOJ_UW			KJU "
            xSqlTxt = xSqlTxt & vbCrLf & ",		M_KAIS				KAI "
            xSqlTxt = xSqlTxt & vbCrLf & ",		M_BMN_UW			BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "		1		=	1 "
            If Hensu.param.pKaisChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "AND	SHI.KAIS			@KAIS_DOM@ "
            End If
            If Hensu.param.pKojChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "AND	SHI.KOJ			    @KOJ_DOM@ "
            End If
            If Hensu.param.pKojUwChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "AND   SHI.KOJ_UW		    @KOJ_UW_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(SHI.KOJ_KMK_KBN = 3) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(SHI.TORIHIKI_KBN = 0) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	SHI.DDATE           <=  @END_DDATE_TO_SIME@ "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(SHI.KMK = KMK.CODE(+)) "
            If Hensu.param.pEigyoTantChk = 1 Then
                xSqlTxt = xSqlTxt & vbCrLf & "AND	KJU.EIGYO_TANT	    @EIGYO_TANT_DOM@ "
            End If
            xSqlTxt = xSqlTxt & vbCrLf & "AND	KJU.KAN_FURI		>=  @START_DDATE_FROM_SIME@ "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	KJU.BMN_UW	IN "
            xSqlTxt = xSqlTxt & vbCrLf & "				(SELECT BMN_UW FROM W_BMN "
            xSqlTxt = xSqlTxt & vbCrLf & "				WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "						@SYSUSERNO@		= USER_NO "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		@SESSION_ID@	= SESSION_ID "
            xSqlTxt = xSqlTxt & vbCrLf & "				AND		@PROGRAM_CODE@	= PROGRAM_CODE) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(SHI.KOJ = KJU.KOJ(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(SHI.KOJ_UW = KJU.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(SHI.KAIS = KAI.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(KJU.BMN_UW = BMN.CODE(+)) "
            xSqlTxt = xSqlTxt & vbCrLf & "AND	(KJU.NYU_KANRI_KBN=0) "
            xSqlTxt = xSqlTxt & vbCrLf & "GROUP BY "
            xSqlTxt = xSqlTxt & vbCrLf & "		SHI.KAIS "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SHI.KOJ "
            xSqlTxt = xSqlTxt & vbCrLf & ",		SHI.KOJ_UW "

        End If

        fSqlTxt_4 = xSqlTxt
    End Function

    ''' <summary>
    ''' fSqlTxt_5
    ''' </summary>
    ''' <returns>SQL文</returns>
    ''' <remarks>元SQLを持ってくる</remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Function fSqlTxt_5() As String
        Dim xSqlTxt As String

        xSqlTxt = ""
        xSqlTxt = xSqlTxt & vbCrLf & "SELECT "
        xSqlTxt = xSqlTxt & vbCrLf & "		SEK.KAIS "
        xSqlTxt = xSqlTxt & vbCrLf & ",		SEK.KOJ "
        If Hensu.param.pKojShukeOpt = 2 Then
            xSqlTxt = xSqlTxt & vbCrLf & ",		SEK.KOJ_UW "
        End If
        xSqlTxt = xSqlTxt & vbCrLf & ",		SEK.SEIK "
        xSqlTxt = xSqlTxt & vbCrLf & ",		COUNT(SEK.SEIK) CNT "
        xSqlTxt = xSqlTxt & vbCrLf & "FROM "
        xSqlTxt = xSqlTxt & vbCrLf & "		D_SEIK				SEK "
        xSqlTxt = xSqlTxt & vbCrLf & "WHERE "
        xSqlTxt = xSqlTxt & vbCrLf & "		1		=	1 "
        If Hensu.param.pKaisChk = 1 Then
            xSqlTxt = xSqlTxt & vbCrLf & "AND	SEK.KAIS			@KAIS_DOM@ "
        End If
        If Hensu.param.pKojChk = 1 Then
            xSqlTxt = xSqlTxt & vbCrLf & "AND	SEK.KOJ 			@KOJ_DOM@ "
        End If
        If Hensu.param.pKojUwChk = 1 Then
            xSqlTxt = xSqlTxt & vbCrLf & "AND	SEK.KOJ_UW 			@KOJ_UW_DOM@ "
        End If
        xSqlTxt = xSqlTxt & vbCrLf & "AND	SEK.SEIK_DATE		<=  @SEIK_DATE@ "
        xSqlTxt = xSqlTxt & vbCrLf & "GROUP BY "
        xSqlTxt = xSqlTxt & vbCrLf & "		SEK.KAIS "
        xSqlTxt = xSqlTxt & vbCrLf & ",		SEK.KOJ "
        If Hensu.param.pKojShukeOpt = 2 Then
            xSqlTxt = xSqlTxt & vbCrLf & ",		SEK.KOJ_UW "
        End If
        xSqlTxt = xSqlTxt & vbCrLf & ",		SEK.SEIK "

        fSqlTxt_5 = xSqlTxt
    End Function

    ''' <summary>
    ''' グループでデータを作成する。 
    ''' </summary>
    ''' <returns></returns>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Function CreateDataGroup() As DataSet
        Dim dsData As New DataSet
        Dim xFilter As String = String.Empty
        Dim xGroup As String = String.Empty
        Dim xGroupOld As String = String.Empty
        Dim xOrder As String = String.Empty
        Dim dtDataReturn As DataTable

        Dim nKais As Integer
        Dim xSeik As String = String.Empty
        Dim xKoj As String = String.Empty
        Dim xKojUw As String = String.Empty
        Dim xHach As String = String.Empty

        dtDataReturn = Hensu.dSReport.Tables(Hensu.W_TUKIBETUSEIK).Clone

        If Hensu.param.pKojShukeOpt = 1 Then
            xOrder = " KAIS, SEIK, KOJ, HACH "
        Else
            xOrder = " KAIS, SEIK, KOJ, KOJ_UW, HACH "
        End If

        ''D_SEIKを取得する 
        Dim dsSeik As DataSet
        Dim xSqlTxt As String = String.Empty
        xSqlTxt = Me.fSqlTxt_5

        'dsSeik
        '' パラメータ変換
        xSqlTxt = ReplaceParam(xSqlTxt)

        '' 抽出実行
        dsSeik = wsCommon.GetDBString("BaseDBController", xSqlTxt)

        For Each dr As DataRow In Hensu.dSReport.Tables(Hensu.W_TUKIBETUSEIK).Select("", xOrder, DataViewRowState.CurrentRows)

            nKais = fToInt(dr.Item("KAIS"))
            xSeik = fToText(dr.Item("SEIK"))
            xKoj = fToText(dr.Item("KOJ"))
            xKojUw = fToText(dr.Item("KOJ_UW"))
            xHach = fToText(dr.Item("HACH"))

            If Hensu.param.pKojShukeOpt = 1 Then
                xGroup = nKais & xSeik & xKoj & xHach
            Else
                xGroup = nKais & xSeik & xKoj & xKojUw & xHach
            End If

            ''グループを変更した場合 
            If xGroup <> xGroupOld Then
                ''グループでフィルタされたデータを保存するテーブル 
                Dim dtDataFilter As DataTable
                ''該当データの新規行を作成する 
                Dim drNew As DataRow = dtDataReturn.NewRow

                xFilter = ""
                xFilter = " KAIS = " & fDtSqlStr(nKais, BrowsefSqlStr.fSqlStr_Integer)
                xFilter = xFilter & " AND SEIK = " & fDtSqlStr(xSeik, BrowsefSqlStr.fSqlStr_Text)
                xFilter = xFilter & " AND KOJ = " & fDtSqlStr(xKoj, BrowsefSqlStr.fSqlStr_Text)
                If Hensu.param.pKojShukeOpt = 2 Then
                    xFilter = xFilter & " AND KOJ_UW = " & fDtSqlStr(xKojUw, BrowsefSqlStr.fSqlStr_Text)
                End If
                xFilter = xFilter & " AND HACH = " & fDtSqlStr(xHach, BrowsefSqlStr.fSqlStr_Text)

                ''仮テーブルの構造を作成する 
                dtDataFilter = Hensu.dSReport.Tables(Hensu.W_TUKIBETUSEIK).Clone
                ''計算用のテーブルにデータを追加する
                For Each drFilter As DataRow In Hensu.dSReport.Tables(Hensu.W_TUKIBETUSEIK).Select(xFilter, "")
                    dtDataFilter.ImportRow(drFilter)
                Next

                ''D_SEIKをフィルタする 
                Dim xFilterSeik As String = String.Empty
                Dim nOthers As Integer = 0
                Dim xOthers As String = ""
                xFilterSeik = ""
                xFilterSeik = " KAIS = " & fDtSqlStr(nKais, BrowsefSqlStr.fSqlStr_Integer)
                xFilterSeik = xFilterSeik & " AND SEIK <> " & fDtSqlStr(xSeik, BrowsefSqlStr.fSqlStr_Text)
                xFilterSeik = xFilterSeik & " AND KOJ = " & fDtSqlStr(xKoj, BrowsefSqlStr.fSqlStr_Text)
                If Hensu.param.pKojShukeOpt = 2 Then
                    xFilterSeik = xFilterSeik & " AND KOJ_UW = " & fDtSqlStr(xKojUw, BrowsefSqlStr.fSqlStr_Text)
                End If

                Dim drSeik() As DataRow
                drSeik = dsSeik.Tables(0).Select(xFilterSeik, "", DataViewRowState.CurrentRows)

                If drSeik.Length > 0 Then
                    nOthers = fToInt(drSeik(0).Item("CNT"))

                    If nOthers > 0 Then
                        xOthers = "*"
                    End If
                End If

                drNew.Item("KAIS") = nKais
                drNew.Item("KAIS_NAME") = dtDataFilter.Compute("MAX(KAIS_NAME)", xFilter)
                drNew.Item("BMN_UW") = dtDataFilter.Compute("MAX(BMN_UW)", xFilter)
                drNew.Item("BMN_UW_NAME") = dtDataFilter.Compute("MAX(BMN_UW_NAME)", xFilter)
                drNew.Item("SEIK") = xSeik
                drNew.Item("SEIK_RYAKU") = dtDataFilter.Compute("MAX(SEIK_RYAKU)", xFilter)
                drNew.Item("SEIK_KANA") = dtDataFilter.Compute("MAX(SEIK_KANA)", xFilter)
                drNew.Item("SEIK_NAME") = dtDataFilter.Compute("MAX(SEIK_NAME)", xFilter)
                drNew.Item("KAISYU_KBN") = dtDataFilter.Compute("MAX(KAISYU_KBN)", xFilter)
                drNew.Item("SIME_HACH") = dtDataFilter.Compute("MAX(SIME_HACH)", xFilter)
                drNew.Item("KAISYU") = dtDataFilter.Compute("MAX(KAISYU)", xFilter)
                drNew.Item("KAISYU_KIN_RITU") = dtDataFilter.Compute("MAX(KAISYU_KIN_RITU)", xFilter)
                drNew.Item("KAISYU_TEG_RITU") = dtDataFilter.Compute("MAX(KAISYU_TEG_RITU)", xFilter)
                drNew.Item("KAISYU_TEG_SAIT") = dtDataFilter.Compute("MAX(KAISYU_TEG_SAIT)", xFilter)
                drNew.Item("HORYU_RITU") = dtDataFilter.Compute("MAX(HORYU_RITU)", xFilter)
                drNew.Item("HANBAI_SW") = dtDataFilter.Compute("MAX(HANBAI_SW)", xFilter)
                drNew.Item("KOJ") = xKoj
                drNew.Item("KOJ_UW") = xKojUw
                drNew.Item("KOJ_NAME") = dtDataFilter.Compute("MAX(KOJ_NAME)", xFilter)
                drNew.Item("HACH") = xHach
                drNew.Item("HACH_NAME") = dtDataFilter.Compute("MAX(HACH_NAME)", xFilter)
                drNew.Item("OTHERS") = xOthers
                drNew.Item("KOUHOU") = dtDataFilter.Compute("MAX(KOUHOU)", xFilter)
                drNew.Item("KOUHOU_NAME") = dtDataFilter.Compute("MAX(KOUHOU_NAME)", xFilter)
                drNew.Item("EIGYO_TANT_NAME") = dtDataFilter.Compute("MAX(EIGYO_TANT_NAME)", xFilter)
                drNew.Item("KOJ_TANT_NAME") = dtDataFilter.Compute("MAX(KOJ_TANT_NAME)", xFilter)
                drNew.Item("SYUNKO") = dtDataFilter.Compute("MAX(SYUNKO)", xFilter)
                drNew.Item("KAN_FURI") = dtDataFilter.Compute("MAX(KAN_FURI)", xFilter)
                drNew.Item("KEIY_KIN") = dtDataFilter.Compute("MAX(KEIY_KIN)", xFilter)
                drNew.Item("ZEI_KIN") = dtDataFilter.Compute("MAX(ZEI_KIN)", xFilter)
                drNew.Item("SEIK_T_KIN") = dtDataFilter.Compute("MAX(SEIK_T_KIN)", xFilter)
                drNew.Item("ZEN_NYU_KIN") = fToDec(dtDataFilter.Compute("SUM(ZEN_NYU_KIN)", xFilter))
                drNew.Item("TOU_NYUK_YOTEI_KIN") = fToDec(dtDataFilter.Compute("SUM(TOU_NYUK_YOTEI_KIN)", xFilter))
                drNew.Item("TOU_SEIK_YOTEI_KIN") = fToDec(dtDataFilter.Compute("SUM(TOU_SEIK_YOTEI_KIN)", xFilter))
                drNew.Item("T_NYU_KIN") = fToDec(dtDataFilter.Compute("SUM(T_NYU_KIN)", xFilter))
                drNew.Item("T_SEI_KIN") = fToDec(dtDataFilter.Compute("SUM(T_SEI_KIN)", xFilter))
                drNew.Item("SEIK_KIN") = fToDec(dtDataFilter.Compute("SUM(SEIK_KIN)", xFilter))
                drNew.Item("SEIK_ZEI") = fToDec(dtDataFilter.Compute("SUM(SEIK_ZEI)", xFilter))
                drNew.Item("NYU_KIN") = fToDec(dtDataFilter.Compute("SUM(NYU_KIN)", xFilter))
                drNew.Item("N1MSEIK_KIN") = fToDec(dtDataFilter.Compute("SUM(N1MSEIK_KIN)", xFilter))
                drNew.Item("N1MSEIK_ZEI") = fToDec(dtDataFilter.Compute("SUM(N1MSEIK_ZEI)", xFilter))
                drNew.Item("N1MSEIK_Y_KIN") = fToDec(dtDataFilter.Compute("SUM(N1MSEIK_Y_KIN)", xFilter))
                drNew.Item("N1MNYU_KIN") = fToDec(dtDataFilter.Compute("SUM(N1MNYU_KIN)", xFilter))
                drNew.Item("NSEIK_KIN") = fToDec(dtDataFilter.Compute("SUM(NSEIK_KIN)", xFilter))
                drNew.Item("NSEIK_ZEI") = fToDec(dtDataFilter.Compute("SUM(NSEIK_ZEI)", xFilter))
                drNew.Item("NSEIK_Y_KIN") = fToDec(dtDataFilter.Compute("SUM(NSEIK_Y_KIN)", xFilter))
                drNew.Item("NNYU_KIN") = fToDec(dtDataFilter.Compute("SUM(NNYU_KIN)", xFilter))
                drNew.Item("N1SEIK_KIN") = fToDec(dtDataFilter.Compute("SUM(N1SEIK_KIN)", xFilter))
                drNew.Item("N1SEIK_ZEI") = fToDec(dtDataFilter.Compute("SUM(N1SEIK_ZEI)", xFilter))
                drNew.Item("N1SEIK_Y_KIN") = fToDec(dtDataFilter.Compute("SUM(N1SEIK_Y_KIN)", xFilter))
                drNew.Item("N1NYU_KIN") = fToDec(dtDataFilter.Compute("SUM(N1NYU_KIN)", xFilter))
                drNew.Item("N2SEIK_KIN") = fToDec(dtDataFilter.Compute("SUM(N2SEIK_KIN)", xFilter))
                drNew.Item("N2SEIK_ZEI") = fToDec(dtDataFilter.Compute("SUM(N2SEIK_ZEI)", xFilter))
                drNew.Item("N2SEIK_Y_KIN") = fToDec(dtDataFilter.Compute("SUM(N2SEIK_Y_KIN)", xFilter))
                drNew.Item("N2NYU_KIN") = fToDec(dtDataFilter.Compute("SUM(N2NYU_KIN)", xFilter))
                drNew.Item("N3SEIK_KIN") = fToDec(dtDataFilter.Compute("SUM(N3SEIK_KIN)", xFilter))
                drNew.Item("N3SEIK_ZEI") = fToDec(dtDataFilter.Compute("SUM(N3SEIK_ZEI)", xFilter))
                drNew.Item("N3SEIK_Y_KIN") = fToDec(dtDataFilter.Compute("SUM(N3SEIK_Y_KIN)", xFilter))
                drNew.Item("N3NYU_KIN") = fToDec(dtDataFilter.Compute("SUM(N3NYU_KIN)", xFilter))
                drNew.Item("N4SEIK_KIN") = fToDec(dtDataFilter.Compute("SUM(N4SEIK_KIN)", xFilter))
                drNew.Item("N4SEIK_ZEI") = fToDec(dtDataFilter.Compute("SUM(N4SEIK_ZEI)", xFilter))
                drNew.Item("N4SEIK_Y_KIN") = fToDec(dtDataFilter.Compute("SUM(N4SEIK_Y_KIN)", xFilter))
                drNew.Item("N4NYU_KIN") = fToDec(dtDataFilter.Compute("SUM(N4NYU_KIN)", xFilter))
                drNew.Item("N5SEIK_KIN") = fToDec(dtDataFilter.Compute("SUM(N5SEIK_KIN)", xFilter))
                drNew.Item("N5SEIK_ZEI") = fToDec(dtDataFilter.Compute("SUM(N5SEIK_ZEI)", xFilter))
                drNew.Item("N5SEIK_Y_KIN") = fToDec(dtDataFilter.Compute("SUM(N5SEIK_Y_KIN)", xFilter))
                drNew.Item("N5NYU_KIN") = fToDec(dtDataFilter.Compute("SUM(N5NYU_KIN)", xFilter))
                drNew.Item("N5MSEIK_KIN") = fToDec(dtDataFilter.Compute("SUM(N5MSEIK_KIN)", xFilter))
                drNew.Item("N5MSEIK_ZEI") = fToDec(dtDataFilter.Compute("SUM(N5MSEIK_ZEI)", xFilter))
                drNew.Item("N5MSEIK_Y_KIN") = fToDec(dtDataFilter.Compute("SUM(N5MSEIK_Y_KIN)", xFilter))
                drNew.Item("N5MNYU_KIN") = fToDec(dtDataFilter.Compute("SUM(N5MNYU_KIN)", xFilter))

                drNew.Item("NMSEIK_NYU_ZAN") = fToDec(drNew.Item("N1MSEIK_KIN")) - fToDec(drNew.Item("N1MNYU_KIN"))
                drNew.Item("NRSEIK_NYU_ZAN") = fToDec(dtDataFilter.Compute("SUM(NRSEIK_KIN )", xFilter)) - fToDec(dtDataFilter.Compute("SUM(NRNYU_KIN)", xFilter))
                drNew.Item("NR1SEIK_NYU_ZAN") = fToDec(dtDataFilter.Compute("SUM(NR1SEIK_KIN)", xFilter)) - fToDec(dtDataFilter.Compute("SUM(NR1NYU_KIN)", xFilter))
                drNew.Item("NR2SEIK_NYU_ZAN") = fToDec(dtDataFilter.Compute("SUM(NR2SEIK_KIN)", xFilter)) - fToDec(dtDataFilter.Compute("SUM(NR2NYU_KIN)", xFilter))
                drNew.Item("NR3SEIK_NYU_ZAN") = fToDec(dtDataFilter.Compute("SUM(NR3SEIK_KIN)", xFilter)) - fToDec(dtDataFilter.Compute("SUM(NR3NYU_KIN)", xFilter))
                drNew.Item("NR4SEIK_NYU_ZAN") = fToDec(dtDataFilter.Compute("SUM(NR4SEIK_KIN)", xFilter)) - fToDec(dtDataFilter.Compute("SUM(NR4NYU_KIN)", xFilter))
                drNew.Item("NR5SEIK_NYU_ZAN") = fToDec(dtDataFilter.Compute("SUM(NR5SEIK_KIN)", xFilter)) - fToDec(dtDataFilter.Compute("SUM(NR5NYU_KIN)", xFilter))
                drNew.Item("N5MSEIK_NYU_ZAN") = fToDec(dtDataFilter.Compute("SUM(N5MSEIK_KIN)", xFilter)) - fToDec(dtDataFilter.Compute("SUM(N5MNYU_KIN)", xFilter))

                drNew.Item("URI_KIN") = fToDec(dtDataFilter.Compute("MAX(URI_KIN)", xFilter))

                ''金額項目がすべて0の場合は表示しない 
                If fToDec(drNew.Item("SEIK_T_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("ZEN_NYU_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("TOU_NYUK_YOTEI_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("TOU_SEIK_YOTEI_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("T_NYU_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("T_SEI_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("SEIK_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("NYU_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N1MSEIK_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N1MSEIK_Y_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N1MNYU_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("NSEIK_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("NSEIK_Y_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("NNYU_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N1SEIK_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N1SEIK_Y_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N1NYU_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N2SEIK_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N2SEIK_Y_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N2NYU_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N3SEIK_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N3SEIK_Y_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N3NYU_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N4SEIK_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N4SEIK_Y_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N4NYU_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N5SEIK_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N5SEIK_Y_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N5NYU_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N5MSEIK_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N5MSEIK_Y_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("N5MNYU_KIN")) <> 0 OrElse _
                        fToDec(drNew.Item("URI_KIN")) <> 0 Then

                    dtDataReturn.Rows.Add(drNew)
                End If
            End If

            xGroupOld = xGroup
        Next

        dsData.Tables.Add(dtDataReturn)
        Return dsData.Copy

    End Function

    ''' <summary>
    ''' ワークテーブルよりデータを取得して帳票に表示する 
    ''' </summary>
    ''' <param name="dsDataReport"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Function GetDataToPrint(ByVal dsDataReport As DataSet) As DataSet
        Dim dsData As New DataSet
        Dim xOrder As String = String.Empty
        Dim dtData As DataTable

        dtData = Hensu.dSReport.Tables("REPORT").Clone

        ''並び順
        If Hensu.param.pOrderOpt = 0 Then
            If Hensu.param.pKojShukeOpt = 1 Then
                xOrder = "KAIS, SEIK, KOJ"
            Else
                xOrder = "KAIS, SEIK, KOJ, KOJ_UW"
            End If
        Else
            If Hensu.param.pKojShukeOpt = 1 Then
                xOrder = "KAIS, SEIK_KANA, SEIK, KOJ"
            Else
                xOrder = "KAIS, SEIK_KANA, SEIK, KOJ, KOJ_UW"
            End If
        End If

        For Each dr As DataRow In dsDataReport.Tables(0).Select("", xOrder, DataViewRowState.CurrentRows)

            ''該当データの新規行を作成する
            Dim drNew As DataRow = dtData.NewRow

            drNew.Item("KAIS") = dr.Item("KAIS")
            drNew.Item("KAIS_NAME") = dr.Item("KAIS_NAME")
            drNew.Item("BMN_UW") = dr.Item("BMN_UW")
            drNew.Item("BMN_UW_NAME") = dr.Item("BMN_UW_NAME")
            drNew.Item("SEIK") = dr.Item("SEIK")
            drNew.Item("SEIK_RYAKU") = dr.Item("SEIK_RYAKU")
            drNew.Item("SEIK_KANA") = dr.Item("SEIK_KANA")
            drNew.Item("SEIK_NAME") = dr.Item("SEIK_NAME")
            drNew.Item("KAISYU_KBN") = dr.Item("KAISYU_KBN")
            drNew.Item("SIME_HACH") = dr.Item("SIME_HACH")
            drNew.Item("KAISYU") = dr.Item("KAISYU")
            drNew.Item("KAISYU_KIN_RITU") = dr.Item("KAISYU_KIN_RITU")
            drNew.Item("KAISYU_TEG_RITU") = dr.Item("KAISYU_TEG_RITU")
            drNew.Item("KAISYU_TEG_SAIT") = dr.Item("KAISYU_TEG_SAIT")
            drNew.Item("HORYU_RITU") = dr.Item("HORYU_RITU")
            drNew.Item("HANBAI_SW") = dr.Item("HANBAI_SW")
            drNew.Item("KOJ") = dr.Item("KOJ")
            drNew.Item("KOJ_UW") = dr.Item("KOJ_UW")
            drNew.Item("KOJ_NAME") = dr.Item("KOJ_NAME")
            drNew.Item("HACH") = dr.Item("HACH")
            drNew.Item("HACH_NAME") = dr.Item("HACH_NAME")
            drNew.Item("OTHERS") = dr.Item("OTHERS")
            drNew.Item("KOUHOU") = dr.Item("KOUHOU")
            drNew.Item("KOUHOU_NAME") = dr.Item("KOUHOU_NAME")
            drNew.Item("EIGYO_TANT_NAME") = dr.Item("EIGYO_TANT_NAME")
            drNew.Item("KOJ_TANT_NAME") = dr.Item("KOJ_TANT_NAME")
            drNew.Item("SYUNKO") = dr.Item("SYUNKO")
            drNew.Item("KAN_FURI") = dr.Item("KAN_FURI")
            drNew.Item("KIN1") = dr.Item("KEIY_KIN")
            drNew.Item("KIN2") = dr.Item("ZEI_KIN")
            drNew.Item("KIN3") = dr.Item("SEIK_T_KIN")
            drNew.Item("KIN4") = dr.Item("N1MSEIK_Y_KIN")
            drNew.Item("KIN5") = dr.Item("N1MSEIK_KIN")
            drNew.Item("KIN6") = dr.Item("N1MNYU_KIN")
            drNew.Item("KIN7") = dr.Item("NSEIK_Y_KIN")
            drNew.Item("KIN8") = dr.Item("NSEIK_KIN")
            drNew.Item("KIN9") = dr.Item("NNYU_KIN")

            ''SELECT区のチェンジ
            Dim nBetMonths As Integer = 0
            ''月間
            nBetMonths = fToInt(DateDiff("m", Hensu.param.pDateFrom, Hensu.param.pDateTo))

            If nBetMonths <> 0 Then
                ''10列目からセットする 
                Dim nStartColumn As Integer = 10
                For i As Integer = 1 To nBetMonths
                    drNew.Item("KIN" & nStartColumn) = dr.Item("N" & i & "SEIK_Y_KIN")
                    drNew.Item("KIN" & nStartColumn + 1) = dr.Item("N" & i & "SEIK_KIN")
                    drNew.Item("KIN" & nStartColumn + 2) = dr.Item("N" & i & "NYU_KIN")
                    nStartColumn = nStartColumn + 3
                Next i
            End If

            If nBetMonths <> 5 Then
                Dim nStartColumn As Integer = 10 + nBetMonths * 3
                For i As Integer = nBetMonths + 1 To 5
                    drNew.Item("KIN" & nStartColumn) = 0
                    drNew.Item("KIN" & nStartColumn + 1) = 0
                    drNew.Item("KIN" & nStartColumn + 2) = 0
                    nStartColumn = nStartColumn + 3
                Next i
            End If

            drNew.Item("KIN25") = dr.Item("N5MSEIK_Y_KIN")
            drNew.Item("KIN26") = dr.Item("N5MSEIK_KIN")
            drNew.Item("KIN26_ZEI") = dr.Item("N5MSEIK_ZEI")
            drNew.Item("KIN27") = dr.Item("N5MNYU_KIN")
            drNew.Item("KIN28") = dr.Item("ZEN_NYU_KIN")
            drNew.Item("KIN29") = dr.Item("TOU_NYUK_YOTEI_KIN")
            drNew.Item("KIN30") = dr.Item("TOU_SEIK_YOTEI_KIN")
            drNew.Item("KIN31") = dr.Item("T_NYU_KIN")
            drNew.Item("KIN32") = dr.Item("T_SEI_KIN")
            drNew.Item("KIN33") = dr.Item("SEIK_KIN")
            drNew.Item("KIN34") = dr.Item("NYU_KIN")
            drNew.Item("KIN_SZ1") = dr.Item("NMSEIK_NYU_ZAN")
            drNew.Item("KIN_SZ2") = dr.Item("NRSEIK_NYU_ZAN")
            drNew.Item("KIN_SZ3") = dr.Item("NR1SEIK_NYU_ZAN")
            drNew.Item("KIN_SZ4") = dr.Item("NR2SEIK_NYU_ZAN")
            drNew.Item("KIN_SZ5") = dr.Item("NR3SEIK_NYU_ZAN")
            drNew.Item("KIN_SZ6") = dr.Item("NR4SEIK_NYU_ZAN")
            drNew.Item("KIN_SZ7") = dr.Item("NR5SEIK_NYU_ZAN")
            drNew.Item("KIN_SZ8") = dr.Item("N5MSEIK_NYU_ZAN")
            drNew.Item("KIN35") = dr.Item("URI_KIN")
            drNew.Item("MISEI_KIN") = fToDec(dr.Item("KEIY_KIN")) - (fToDec(dr.Item("N5MSEIK_KIN")) - fToDec(dr.Item("N5MSEIK_ZEI")))

            Dim bRet As Boolean = True      ''Trueであれば条件満足とする 
            Dim bRetTmp As Boolean = False  ''Trueであれば条件満足とする 

            ''会社
            bRetTmp = False
            If Hensu.param.pKaisChk = 1 Then
                If fToInt(dr.Item("KAIS")) >= Hensu.param.pKaisFrom AndAlso fToInt(dr.Item("KAIS")) <= Hensu.param.pKaisTo Then
                    bRetTmp = True
                End If
            Else
                bRetTmp = True
            End If

            If bRetTmp = False Then
                bRet = False
            End If

            ''未成/完成
            bRetTmp = False
            If Hensu.param.pKanseiOpt = 1 Then
                If fToDate(dr.Item("KAN_FURI")) > fEndDate(Hensu.param.pDateTo, Hensu.nKaisSime) Then
                    bRetTmp = True
                End If
            ElseIf Hensu.param.pKanseiOpt = 2 Then
                If fToDate(dr.Item("KAN_FURI")) <= fEndDate(Hensu.param.pDateTo, Hensu.nKaisSime) Then
                    bRetTmp = True
                End If
            Else
                bRetTmp = True
            End If

            If bRetTmp = False Then
                bRet = False
            End If

            ''締日
            bRetTmp = False
            If Hensu.param.pSimeDate <> 0 Then
                If fToInt(dr.Item("SIME_HACH")) = Hensu.param.pSimeDate Then
                    bRetTmp = True
                End If
            Else
                bRetTmp = True
            End If

            If bRetTmp = False Then
                bRet = False
            End If

            bRetTmp = False
            If fToDec(dr.Item("N1MSEIK_KIN")) <> fToDec(dr.Item("N5MSEIK_KIN")) OrElse _
                fToDec(dr.Item("N1MNYU_KIN")) <> fToDec(dr.Item("N5MNYU_KIN")) OrElse _
                (fToDec(dr.Item("HANBAI_SW")) = 0 AndAlso (fToDec(dr.Item("KEIY_KIN")) - (fToDec(dr.Item("N5MSEIK_KIN")) - fToDec(dr.Item("N5MSEIK_ZEI")))) <> 0) OrElse _
                fToDec(dr.Item("N5MSEIK_NYU_ZAN")) <> 0 Then
                bRetTmp = True
            End If

            If bRetTmp = False Then
                bRet = False
            End If

            If bRet = True Then
                dtData.Rows.Add(drNew)
            End If
        Next

        dsData.Tables.Add(dtData)
        Return dsData.Copy

    End Function

    ''' <summary>
    ''' パラメータ置換
    ''' </summary>
    ''' <param name="pSqlStr"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Function ReplaceParam(ByVal pSqlStr As String) As String
        Dim dDate As Date

        ''会社コード
        pSqlStr = pSqlStr.Replace("@KAIS_DOM@", Hensu.param.pKaisDom)

        '' 部門階層
        pSqlStr = fReplaceString(pSqlStr, "@BMN_KAISOU@", fSqlStr(Hensu.param.pBmnKaisou, BrowsefSqlStr.fSqlStr_Integer))

        '' 部門
        pSqlStr = pSqlStr.Replace("@BMN_UW_DOM@", Hensu.param.pBmnUwDom)

        ''工事
        pSqlStr = pSqlStr.Replace("@KOJ_DOM@", Hensu.param.pKojDom)

        ''工事詳細
        pSqlStr = pSqlStr.Replace("@KOJ_UW_DOM@", Hensu.param.pKojUwDom)

        ''請求先
        pSqlStr = pSqlStr.Replace("@TOR_DOM@", Hensu.param.pTorDom)

        ''営業担当者
        pSqlStr = pSqlStr.Replace("@EIGYO_TANT_DOM@", Hensu.param.pEigyoTantDom)

        ''SEIK_DATE
        dDate = fProcessMonth(Hensu.param.pDateTo, Hensu.nKaisSime)
        dDate = fEndDate(dDate, Hensu.nKaisSime)
        pSqlStr = pSqlStr.Replace("@SEIK_DATE@", fSqlStr(dDate, BrowsefSqlStr.fSqlStr_DATE))

        ''開始年月日
        dDate = fStartDate(Hensu.param.pDateFrom, Hensu.nKaisSime)
        pSqlStr = pSqlStr.Replace("@START_DDATE_FROM_SIME@", fSqlStr(dDate, BrowsefSqlStr.fSqlStr_DATE))

        ''終了年月日
        dDate = fEndDate(Hensu.param.pDateTo, Hensu.nKaisSime)
        pSqlStr = pSqlStr.Replace("@END_DDATE_TO_SIME@", fSqlStr(dDate, BrowsefSqlStr.fSqlStr_DATE))

        dDate = fStartDate(Hensu.param.pDateFrom, 31)
        pSqlStr = pSqlStr.Replace("@START_DDATE_FROM_1@", fSqlStr(dDate, BrowsefSqlStr.fSqlStr_DATE))
        ''会社締日
        pSqlStr = pSqlStr.Replace("@SIME_DATE@", fSqlStr(Hensu.nKaisSime, BrowsefSqlStr.fSqlStr_Integer))

        '' ユーザーID
        pSqlStr = fReplaceString(pSqlStr, "@SYSUSERNO@", fSqlStr(SysUserNo, BrowsefSqlStr.fSqlStr_Integer))

        '' プログラムコード
        pSqlStr = fReplaceString(pSqlStr, "@PROGRAM_CODE@", fSqlStr(Hensu.MyProgramCode, BrowsefSqlStr.fSqlStr_Integer))

        Return pSqlStr

    End Function

    ''' <summary>
    ''' 仮想部門表の作成
    ''' </summary>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub InsertW_BMN()
        Try
            Dim xSqlTxt As String = String.Empty
            ''テンポラリに部門コード代入
            xSqlTxt = "	INSERT	INTO "
            xSqlTxt = xSqlTxt & "		W_BMN "
            xSqlTxt = xSqlTxt & "	( "
            xSqlTxt = xSqlTxt & "		USER_NO "
            xSqlTxt = xSqlTxt & "	,	SESSION_ID "
            xSqlTxt = xSqlTxt & "	,	PROGRAM_CODE "
            xSqlTxt = xSqlTxt & "	,	BMN_UW "
            xSqlTxt = xSqlTxt & "	,	S_BMN_UW "
            xSqlTxt = xSqlTxt & "	) "
            xSqlTxt = xSqlTxt & "	SELECT "
            xSqlTxt = xSqlTxt & "			@SYSUSERNO@					USER_NO "
            xSqlTxt = xSqlTxt & "		,	@SESSION_ID@				SESSION_ID "
            xSqlTxt = xSqlTxt & "		,	" & fSqlStr(Hensu.param.pReportCode, BrowsefSqlStr.fSqlStr_Long) & "			PROGRAM_CODE "
            If Hensu.param.pBmnKaisouChk = 1 Then
                xSqlTxt = xSqlTxt & "	,	BSU.BMN_UW					BMN_UW "
                xSqlTxt = xSqlTxt & "	,	BSU.S_BMN_UW				S_BMN_UW "
                xSqlTxt = xSqlTxt & "	FROM "
                xSqlTxt = xSqlTxt & "			M_BMN_SUMMARY				BSU "
                xSqlTxt = xSqlTxt & "		,	S_BMN_UW					SUW "
                xSqlTxt = xSqlTxt & "	WHERE "
                xSqlTxt = xSqlTxt & "			BSU.S_BMN_UW		=		SUW.CODE "
                xSqlTxt = xSqlTxt & "	AND		SUW.USER_NO			=		@SYSUSERNO@ "
                xSqlTxt = xSqlTxt & "	AND		SUW.KAISOU			=       @BMN_KAISOU@"
                If Hensu.param.pBmnUwChk = 1 Then
                    xSqlTxt = xSqlTxt & "	AND		BSU.S_BMN_UW	        @BMN_UW_DOM@"
                End If
            Else
                xSqlTxt = xSqlTxt & "		,	SUW.CODE					BMN_UW "
                xSqlTxt = xSqlTxt & "		,	SUW.CODE					S_BMN_UW "
                xSqlTxt = xSqlTxt & "	FROM  "
                xSqlTxt = xSqlTxt & "			S_BMN_UW					SUW "
                xSqlTxt = xSqlTxt & "	WHERE "
                xSqlTxt = xSqlTxt & "			SUW.USER_NO			=		@SYSUSERNO@ "
                If Hensu.param.pBmnUwChk = 1 Then
                    xSqlTxt = xSqlTxt & "	AND		SUW.CODE		        @BMN_UW_DOM@"
                End If
            End If

            ''パラメータ置換
            xSqlTxt = Me.ReplaceParam(xSqlTxt)

            'SQLの実行
            wsCommon.ExecuteSQLCommand("BaseDBController", xSqlTxt)

        Catch ex As Exception
            ''何もしない
        End Try

    End Sub

    ''' <summary>
    ''' 仮想部門表の初期化
    ''' </summary>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub DeleteW_BMN()
        Try
            Dim xSqlTxt As String = String.Empty

            xSqlTxt = xSqlTxt & vbCrLf & " DELETE "
            xSqlTxt = xSqlTxt & vbCrLf & " FROM "
            xSqlTxt = xSqlTxt & vbCrLf & "	    W_BMN "
            xSqlTxt = xSqlTxt & vbCrLf & " WHERE "
            xSqlTxt = xSqlTxt & vbCrLf & "      SESSION_ID      =   @SESSION_ID@ "
            xSqlTxt = xSqlTxt & vbCrLf & " AND  USER_NO         =   @SYSUSERNO@ "
            xSqlTxt = xSqlTxt & vbCrLf & " AND  PROGRAM_CODE    =   @PROGRAM_CODE@ "

            ''パラメータ置換
            xSqlTxt = Me.ReplaceParam(xSqlTxt)

            '' SQLの実行
            wsCommon.ExecuteSQLCommand("BaseDBController", xSqlTxt)
        Catch ex As Exception
            '' 何もしない
        End Try
    End Sub

    ''' <summary>
    ''' プログラムに必要な会社マスタの値をとってくる
    ''' </summary>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub GetKaisMaster(ByVal pKais As Integer)
        Dim xSqlTxt As String
        Dim ds As DataSet

        xSqlTxt = ""
        xSqlTxt = xSqlTxt & vbCrLf & "SELECT"
        xSqlTxt = xSqlTxt & vbCrLf & "     KAI.*"
        xSqlTxt = xSqlTxt & vbCrLf & "FROM"
        xSqlTxt = xSqlTxt & vbCrLf & "     M_KAIS KAI"
        xSqlTxt = xSqlTxt & vbCrLf & "WHERE"
        xSqlTxt = xSqlTxt & vbCrLf & "     KAI.CODE     = @CODE@"
        xSqlTxt = xSqlTxt.Replace("@CODE@", fSqlStr(pKais, BrowsefSqlStr.fSqlStr_Integer))
        ds = wsCommon.GetDBString("BaseDBController", xSqlTxt)
        If ds.Tables(0).Rows.Count <> 0 Then
            '会社名
            Hensu.xKaisName = fToText(ds.Tables(0).Rows(0).Item("NAME"))
            Hensu.nKaisSime = fToInt(ds.Tables(0).Rows(0).Item("SIME"))
        End If
    End Sub

#End Region

#Region "　レポート出力用データセット取得　"

    ''' <summary>getDataSet -- レポート出力用データセット取得</summary>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Function getDataSet() As DataSet

        Dim ds As New DataSet

        Try
            ''データを取得しワークテーブルに挿入する 
            Call Me.GetDataToWork()

            ''グループでデータを作成する。 
            ds = CreateDataGroup()

            ''印刷用のデータを取得する 
            ds = GetDataToPrint(ds)

            ''データがない場合はエラーとする
            If IsNothing(ds) Then
                Throw New Exception("対象データの取得に失敗しました")
            ElseIf ds.Tables(0).Rows.Count < 1 Then
                Throw New Exception("DataNothing")
            End If

            Return ds

        Catch ex As Exception
            IsError = True
            ErrorMsg = ex.Message
            Throw ex
            Return Nothing
        End Try

    End Function

#End Region

#Region "レポートイベント"

    ''' <summary>
    ''' レポート作成開始
    ''' </summary>
    ''' <remarks>レポートに出力用データを割当</remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub CreateReportStart(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.ReportStart

        Try

            ''データソース設定
            Me.DataSource = DsRep
            Me.DataMember = DsRep.Tables(0).ToString

            '会社名表示
            If Hensu.param.pKaisPrint = 1 Then ''印刷しない
                Me.txtKAIS_NAME.Text = String.Empty
            Else ''印刷する
                Me.txtKAIS_NAME.Text = Hensu.xKaisName
            End If

            '出力日表示
            If Hensu.param.pSysDatePrint = 1 Then ''印刷しない
                Me.txtSysDate.Visible = False
                Me.txtSysDate.Text = String.Empty
            Else ''印刷する
                Me.txtSysDate.Visible = True
                Me.txtSysDate.Text = Format(Now, "yyyy/MM/dd HH:mm:ss")
            End If

            ''タイトル
            Me.txtREPORT_TITLE.Text = Me.ReportTitle

            '帳票番号表示
            If Hensu.param.pReportPrint = 1 Then
                Me.txtDocNo.Text = String.Empty
            Else
                Me.txtDocNo.Text = Me.DocNo
            End If

            ''出力順
            If Hensu.param.pOrderOpt = 0 Then
                Me.txtORDER_OPT_NAME.Text = "コード順"
            Else
                Me.txtORDER_OPT_NAME.Text = "カナ順"
            End If

            ''該当年月
            If Hensu.KanDateFormat = 1 Then
                Me.txtDDATE.Text = "(該当年月)　　" & SiuFormat(Hensu.param.pDateFrom, "gggee年MM月度") & "  ～  " & SiuFormat(Hensu.param.pDateTo, "gggee年MM月度")
            Else
                Me.txtDDATE.Text = "(該当年月)　　" & SiuFormat(Hensu.param.pDateFrom, "yyyy年MM月度") & "  ～  " & SiuFormat(Hensu.param.pDateTo, "yyyy年MM月度")
            End If

            ''未成/完成
            Select Case Hensu.param.pKanseiOpt
                Case 0
                    Me.txtKANSEI_OPT.Text = "全て"
                Case 1
                    Me.txtKANSEI_OPT.Text = "未成"
                Case 2
                    Me.txtKANSEI_OPT.Text = "完成"
            End Select

            ''支払情報を表示する 
            If Hensu.param.pKojShukeOpt = 1 Then
                Me.GroupHeader2.Visible = True
                Me.GroupHeader3.Visible = False
            Else
                Me.GroupHeader2.Visible = False
                Me.GroupHeader3.Visible = True
            End If

        Catch ex As Exception
            '' レポート開始エラー
            IsError = True
            ErrorMsg = ex.Message
        End Try

    End Sub

    ''' <summary>
    ''' 明細行設定
    ''' </summary>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub Detail_Format(ByVal sender As Object, ByVal e As System.EventArgs) Handles Detail.Format
        Try
            ''工事表示
            If Hensu.param.pKojShukeOpt = 1 Then
                If SysKojFormatType = 0 Then
                    Me.txtKOJ.Text = fCodeformat(Me.Fields("KOJ").Value) & "  " & fToText(Me.Fields("KOJ_NAME").Value)
                Else
                    Me.txtKOJ.Text = fToText(Me.Fields("KOJ").Value) & "  " & fToText(Me.Fields("KOJ_NAME").Value)
                End If
            Else
                If SysKojUwFormatType = 0 Then
                    Me.txtKOJ.Text = fCodeformat(fToText(Me.Fields("KOJ_UW").Value)) & "  " & fToText(Me.Fields("KOJ_NAME").Value)
                Else
                    Me.txtKOJ.Text = fToText(Me.Fields("KOJ_UW").Value) & "  " & fToText(Me.Fields("KOJ_NAME").Value)
                End If
            End If

            ''発注者表示
            If SysTorFormatType = 0 Then
                Me.txtHACH.Text = fCodeformat(fToText(Me.Fields("HACH").Value)) & "  " & fToText(Me.Fields("HACH_NAME").Value)
            Else
                Me.txtHACH.Text = fToText(Me.Fields("HACH").Value) & "  " & fToText(Me.Fields("HACH_NAME").Value)
            End If

            ''部門表示
            Me.txtBMN_UW.Text = fToText(Me.Fields("BMN_UW").Value) & "  " & fToText(Me.Fields("BMN_UW_NAME").Value)

            ''工法
            If fToInt(Me.Fields("KOUHOU").Value) = SysMinCode Then
                Me.txtKOUHOU.Text = ""
            Else
                Me.txtKOUHOU.Text = fCodeformat(Me.Fields("KOUHOU").Value) & "  " & fToText(Me.Fields("KOUHOU_NAME").Value)
            End If

            ''竣工日
            If fToDate(Me.Fields("SYUNKO").Value) <> SysMaxDate Then
                If Hensu.KanDateFormat = 1 Then
                    Me.txtSYUNKO.Text = SiuFormat(fToDate(Me.Fields("SYUNKO").Value), "gggee年MM月dd日")
                Else
                    Me.txtSYUNKO.Text = SiuFormat(fToDate(Me.Fields("SYUNKO").Value), "yyyy年MM月dd日")
                End If
            Else
                Me.txtSYUNKO.Text = ""
            End If

            ''完成振替日
            If fToDate(Me.Fields("KAN_FURI").Value) <> SysMaxDate Then
                If Hensu.KanDateFormat = 1 Then
                    Me.txtKAN_FURI.Text = SiuFormat(fToDate(Me.Fields("KAN_FURI").Value), "gggee年MM月dd日")
                Else
                    Me.txtKAN_FURI.Text = SiuFormat(fToDate(Me.Fields("KAN_FURI").Value), "yyyy年MM月dd日")
                End If
            Else
                Me.txtKAN_FURI.Text = ""
            End If

            ''営業担当者
            Me.txtEIGYO_TANT_NAME.Text = fToText(Me.Fields("EIGYO_TANT_NAME").Value)
            ''工事担当者
            Me.txtKOJ_TANT_NAME.Text = fToText(Me.Fields("KOJ_TANT_NAME").Value)

        Catch ex As Exception
            '' レポート開始エラー
            IsError = True
            ErrorMsg = ex.Message
        End Try
    End Sub

    ''' <summary>
    ''' ページヘッダの設定
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub PageHeader_Format(ByVal sender As Object, ByVal e As System.EventArgs) Handles PageHeader.Format
        Try
            Dim dFDate As Date
            Dim dTDate As Date
            Dim nBetMonths As Integer = 0
            Dim nMonth As Integer = 0
            Dim nMonthMod As Integer = 0

            dFDate = fStartDate(Hensu.param.pDateFrom, 31)
            dTDate = fStartDate(Hensu.param.pDateTo, 31)
            nBetMonths = fToInt(DateDiff("m", dFDate, dTDate))

            Me.lblN1MY.Text = Month(DateAdd("m", -1, dFDate)) & "月迄請求予定"
            Me.lblNY.Text = Month(dFDate) & "月請求予定"
            If nBetMonths <> 0 Then
                For i As Integer = 1 To nBetMonths
                    CType(Me.PageHeader.Controls("lblNY" & i), DataDynamics.ActiveReports.Label).Visible = True
                    nMonth = Month(dFDate) + i
                    nMonthMod = nMonth Mod 12
                    If nMonthMod = 0 Then
                        nMonthMod = 12
                    End If
                    CType(Me.PageHeader.Controls("lblNY" & i), DataDynamics.ActiveReports.Label).Text = nMonthMod & "月請求予定"
                Next i
            End If

            If nBetMonths <> 5 Then
                For i As Integer = nBetMonths + 1 To 5
                    CType(Me.PageHeader.Controls("lblNY" & i), DataDynamics.ActiveReports.Label).Text = ""
                    CType(Me.PageHeader.Controls("lblNS" & i), DataDynamics.ActiveReports.Label).Text = ""
                    CType(Me.PageHeader.Controls("lblNN" & i), DataDynamics.ActiveReports.Label).Text = ""
                    CType(Me.PageHeader.Controls("lblSN" & i), DataDynamics.ActiveReports.Label).Text = ""
                Next i
            End If
            Me.lblN5MY.Text = Month(dTDate) & "月迄請求予定額"
        Catch ex As Exception
            '' レポート開始エラー
            IsError = True
            ErrorMsg = ex.Message
        End Try
    End Sub

    ''' <summary>
    ''' グループフッタ2（請求先ヘッダ）の設定
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub GroupHeader2_Format(ByVal sender As Object, ByVal e As System.EventArgs) Handles GroupHeader2.Format
        Try
            Dim xKaisyu As String

            If Hensu.param.pKojShukeOpt = 1 Then

                ''工事名
                Me.txtKOJ_NAME.Text = ""

                ''取引先表示
                Me.txtSEIK.Text = "  " & fToText(Me.Fields("SEIK").Value) & "  " & fToText(Me.Fields("SEIK_NAME").Value)

                Select Case fToInt(Me.Fields("KAISYU_KBN").Value)
                    Case 0
                        xKaisyu = "当月"
                    Case 1
                        xKaisyu = "翌月"
                    Case 2
                        xKaisyu = "翌々月"
                    Case 3
                        xKaisyu = "翌々々月"
                    Case Else
                        xKaisyu = "その他"
                End Select

                Me.txtSIME_HACH.Text = fToInt(Me.Fields("SIME_HACH").Value) & "日"
                Me.txtKAISYU.Text = xKaisyu & fToText(Me.Fields("KAISYU").Value) & "日"
                Me.txtHORYU_RITU.Text = SiuFormat(fToDec(Me.Fields("HORYU_RITU").Value), "##0.00") & "%"
                Me.txtKAISYU_KIN_RITU.Text = SiuFormat(fToDec(Me.Fields("KAISYU_KIN_RITU").Value), "##0.00") & "%"
                Me.txtKAISYU_TEG_RITU.Text = SiuFormat(fToDec(Me.Fields("KAISYU_TEG_RITU").Value), "##0.00") & "%"
                Me.txtKAISYU_TEG_SAIT.Text = fToInt(Me.Fields("KAISYU_TEG_SAIT").Value) & "日"

            End If

        Catch ex As Exception
            '' レポート開始エラー
            IsError = True
            ErrorMsg = ex.Message
        End Try
    End Sub

    ''' <summary>
    ''' グループフッタ3（工事ヘッダ）の設定
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub GroupHeader3_Format(ByVal sender As Object, ByVal e As System.EventArgs) Handles GroupHeader3.Format
        Try
            Dim xKaisyu As String

            If Hensu.param.pKojShukeOpt = 2 Then

                ''工事名
                Me.txtKOJ_NAME2.Text = "  " & fToText(Me.Fields("KOJ").Value) & "  " & fToText(Me.Fields("KOJ_NAME").Value)

                ''請求先表示
                Me.txtSEIK2.Text = "  " & fToText(Me.Fields("SEIK").Value) & "  " & fToText(Me.Fields("SEIK_NAME").Value)

                Select Case fToInt(Me.Fields("KAISYU_KBN").Value)
                    Case 0
                        xKaisyu = "当月"
                    Case 1
                        xKaisyu = "翌月"
                    Case 2
                        xKaisyu = "翌々月"
                    Case 3
                        xKaisyu = "翌々々月"
                    Case Else
                        xKaisyu = "その他"
                End Select

                Me.txtSIME_HACH2.Text = fToInt(Me.Fields("SIME_HACH").Value) & "日"
                Me.txtKAISYU2.Text = xKaisyu & fToInt(Me.Fields("KAISYU").Value) & "日"
                Me.txtHORYU_RITU2.Text = SiuFormat(fToDec(Me.Fields("HORYU_RITU").Value), "##0.00") & "%"
                Me.txtKAISYU_KIN_RITU2.Text = SiuFormat(fToDec(Me.Fields("KAISYU_KIN_RITU").Value), "##0.00") & "%"
                Me.txtKAISYU_TEG_RITU2.Text = SiuFormat(fToDec(Me.Fields("KAISYU_TEG_RITU").Value), "##0.00") & "%"
                Me.txtKAISYU_TEG_SAIT2.Text = fToInt(Me.Fields("KAISYU_TEG_SAIT").Value) & "日"

            End If
        Catch ex As Exception
            '' レポート開始エラー
            IsError = True
            ErrorMsg = ex.Message
        End Try
    End Sub

    ''' <summary>
    ''' 仮テーブルのデータを削除する
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    ''' <history version="1" date="2013.12.12" name="HUY-NQ">新規作成</history>
    Protected Overridable Sub Report_ReportEnd(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.ReportEnd
        Try
            ''W_BMNテーブルのデータを削除する
            Me.DeleteW_BMN()

        Catch ex As Exception
            IsError = True
            ErrorMsg = ex.Message
        End Try
    End Sub

#End Region

End Class
